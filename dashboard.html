<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© - Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

    <link href="jsCalendar.min.css" rel="stylesheet">
    <script src="jsCalendar.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore-compat.js"></script>

    <style>
        /* --- CSS Styles Ø§Ù„Ø¹Ø§Ù…Ø© (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f4f7f6; color: #333; line-height: 1.7; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }
        h1, h2, h3, h4 { color: #1a5276; margin-bottom: 0.75em; }
        p { margin-bottom: 1em; color: #555; font-size: 0.95em; }
        a { text-decoration: none; color: #2980b9; }
        .card { background-color: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 3px 6px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; }

        /* --- Header (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) --- */
        .dashboard-header { display: flex; justify-content: center; align-items: center; padding: 10px 20px; margin-bottom: 25px; border-bottom: 2px solid #aed6f1; background-color: #fff; border-radius: 0 0 8px 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .dashboard-header .logo h1 { margin: 0; font-size: 1.8em; color: #1a5276; }

        /* --- Dashboard Layout (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) --- */
        .dashboard-grid { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: auto; gap: 25px; }
        #daily-task { grid-column: span 2; }
        #plan-progress { grid-column: 1 / 2; grid-row: 2 / 3; }
        #quick-stats { grid-column: 1 / 2; grid-row: 3 / 4; }
        #streak-level { grid-column: 2 / 4; grid-row: 2 / 3; }
        #calendar-view { grid-column: 2 / 4; grid-row: 3 / 4; }

        /* --- Section Specific Styles (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) --- */
        #daily-task h3 { color: #1e8449; font-size: 1.3em; border-bottom: 2px solid #aed6f1; padding-bottom: 8px;}
        #daily-task-content { min-height: 80px; padding-top: 10px;}
        #daily-task-content p { margin-bottom: 0.6em; font-size: 1.05em; line-height: 1.8; }
        #daily-task-content strong { color: #1a5276; margin-left: 8px;}
        #daily-task .plan-link { margin-top: 15px; display: inline-block; font-size: 0.9em; background-color: #5dade2; color: white; padding: 5px 10px; border-radius: 4px; }
        #daily-task .plan-link:hover { background-color: #3498db; }
        #plan-progress h3, #quick-stats h3, #calendar-view h3, #competition-section h3, #badges-section h3, #streak-level h3 { font-size: 1.15em; }
        #plan-progress .progress-bar-container { background-color: #e9ecef; border-radius: 0.25rem; height: 25px; overflow: hidden; margin-top: 10px; border: 1px solid #ccc; }
        #plan-progress .progress-bar-value { background-color: #28a745; height: 100%; width: 0%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.9em; font-weight: bold; transition: width 0.6s ease-in-out; }
        #quick-stats ul { list-style: none; padding: 0; margin-top: 15px;}
        #quick-stats ul li { margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px dotted #eee; font-size: 0.95em;}
        #quick-stats ul li strong { margin-left: 5px; color: #1a5276; min-width: 110px; display: inline-block;}
        #quick-stats ul li span { color: #1e8449; font-weight: bold;}
        #streak-level .streak-info { display: flex; justify-content: space-around; text-align: center; margin: 15px 0; }
        #streak-level .streak-info div { background-color: #eaf2f8; padding: 10px 15px; border-radius: 6px; border: 1px solid #d4e6f1; }
        #streak-level .streak-info strong { display: block; font-size: 1.5em; color: #1e8449; }
        #streak-level .level-title-container { text-align: center; margin-top: 15px; }
        #streak-level #level-title { font-size: 1.2em; color: #2c3e50; font-weight: bold; }
        #streak-level #level-icon { font-size: 1.5em; margin-left: 10px; }

        /* --- Calendar Styles (jsCalendar) --- */
        #calendar-view { min-height: 280px; }
        #calendar-container { margin-top: 15px; }
        /* --- ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚Ø§Øª Vanilla Calendar Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© --- */

        /* --- ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù€ jsCalendar --- */
        /* ØªØ³ØªÙ‡Ø¯Ù Ø¹Ù†ØµØ± Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø°ÙŠ ØªØ¶ÙŠÙ Ù„Ù‡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ */
        .jsCalendar-day-number.day-completed {
            background-color: #abebc6 !important; /* Ø£Ø®Ø¶Ø± ÙØ§ØªØ­ */
            color: #186a3b !important; /* Ù†Øµ Ø£Ø®Ø¶Ø± Ø£ØºÙ…Ù‚ */
            border-radius: 50% !important; /* Ø¯Ø§Ø¦Ø±ÙŠ */
            font-weight: bold !important;
            display: inline-block !important;
            width: 1.9em !important; /* Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„ØªØ¹Ø¯ÙŠÙ„ */
            line-height: 1.9em !important; /* Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„ØªØ¹Ø¯ÙŠÙ„ */
            text-align: center !important;
        }
        .jsCalendar-day-number.day-excused {
            background-color: #fadbd8 !important; /* Ø£Ø­Ù…Ø± ÙØ§ØªØ­ */
            color: #922b21 !important; /* Ù†Øµ Ø£Ø­Ù…Ø± Ø£ØºÙ…Ù‚ */
            border-radius: 50% !important; /* Ø¯Ø§Ø¦Ø±ÙŠ */
            font-weight: bold !important;
            display: inline-block !important;
            width: 1.9em !important;
            line-height: 1.9em !important;
            text-align: center !important;
        }
         /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù€ jsCalendar */
        .jsCalendar-day-number.jsCalendar-today {
             background-color: #e3f2fd !important; /* Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ */
             border: 1px solid #aed6f1 !important;
             color: #1a5276 !important;
             border-radius: 50% !important;
         }
        /* --- Ù†Ù‡Ø§ÙŠØ© ØªÙ†Ø³ÙŠÙ‚Ø§Øª jsCalendar --- */

        /* Placeholder Styles (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) */
        .placeholder-box { min-height: 150px; background-color: #f0f4f8; border: 1px dashed #ccc; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #777; border-radius: 5px; padding: 15px; text-align: center; }
        .placeholder-box .icon { font-size: 3em; margin-bottom: 10px; opacity: 0.5; }
        .placeholder-box .text { font-style: italic; font-size: 0.9em; }

        /* Footer (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) */
        .main-footer { text-align: center; padding: 20px; margin-top: 40px; background-color: #2c3e50; color: #ecf0f1; font-size: 0.9em; }
        .main-footer a { color: #3498db; }

        /* Action Buttons Hidden (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) */
        .action-buttons { display: none; }

        /* Loading Indicator (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) */
        #loading-indicator { text-align: center; padding: 50px; font-size: 1.3em; color: #1a5276; display: block; }

        /* Responsive Adjustments (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) */
        @media (max-width: 992px) { /* ... */ }
        @media (max-width: 768px) { /* ... */ }
        @media (max-width: 600px) { /* ... */ }
    </style>
</head>
<body>

    <div class="container">

        <header class="dashboard-header">
            <div class="logo"><h1>Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1></div>
        </header>

        <div id="loading-indicator">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

        <main id="dashboard-content" style="display: none;">

            <div class="dashboard-grid">

                <section id="daily-task" class="card">
                    <h3>ğŸŒŸ ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙŠÙˆÙ… (<span id="today-date-display">...</span>)</h3>
                    <div id="daily-task-content">
                        <p><i>ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ§Ø¬Ø¨...</i></p>
                    </div>
                    <a href="plangen2.html" class="plan-link">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ &raquo;</a>
                </section>

                <section id="plan-progress" class="card">
                    <h3>Ø§Ù„Ø®Ø·Ø© ÙˆØ§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…</h3>
                    <p><strong>Ø®Ø·ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> <span id="current-plan-name">-</span></p>
                    <p><strong>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ÙƒÙ„ÙŠ:</strong></p>
                    <div class="progress-bar-container">
                        <div id="progress-bar-value" style="width: 0%; background-color: #28a745;">0%</div>
                    </div>
                    <p style="font-size: 0.9em; text-align: center; margin-top: 5px;">
                        <span id="completed-pages-progress">0</span> / 604 ØµÙØ­Ø©
                    </p>
                </section>

                <section id="quick-stats" class="card">
                    <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                    <ul>
                         <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</strong> <span id="stat-memorized">0</span></li>
                         <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªÙ‚Ù†Ø©:</strong> <span id="stat-perfected">0</span></li>
                         <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©:</strong> <span id="stat-linked">0</span></li>
                         <li><strong>Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø¹Ø°Ø§Ø±:</strong> <span id="stat-excuses">0</span></li>
                    </ul>
                </section>

                <section id="streak-level" class="card">
                     <h3> Ù‡Ù…Ø© Ù†Ø­Ùˆ Ø§Ù„Ù‚Ù…Ø©: Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ</h3>
                     <div class="streak-info">
                         <div>Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø­Ø§Ù„ÙŠØ©<strong id="current-streak">0</strong></div>
                         <div> Ø£Ø·ÙˆÙ„ Ø³Ù„Ø³Ù„Ø© Ø£ÙŠØ§Ù… Ø­Ù‚Ù‚ØªÙ‡Ø§<strong id="longest-streak">0</strong></div>
                     </div>
                     <div class="level-title-container">
                         <h4>Ù„Ù‚Ø¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="level-title">Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ!</span> <span id="level-icon"></span></h4>
                     </div>
                </section>
                <section id="calendar-view" class="card">
                    <h3>Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØ§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø±Ø¦ÙŠ</h3>
                    <div id="calendar-container">
                        <p class="text" style="text-align: center; margin-top: 20px;">(Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…...)</p>
                    </div>
                </section>

                <section id="competition-section" class="card" style="display: none;"> <h3>Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©</h3>
                     <div class="placeholder-box">
                         <div class="icon">ğŸ†</div>
                         <div class="text">(Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©)</div>
                     </div>
                </section>
                <section id="badges-section" class="card" style="display: none;"> <h3>Ø§Ù„Ø£ÙˆØ³Ù…Ø©</h3>
                     <div class="placeholder-box">
                          <div class="icon">ğŸ…</div>
                          <div class="text">(Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙˆØ³Ù…Ø© ÙˆØ§Ù„Ø­ÙˆØ§ÙØ²)</div>
                     </div>
                </section>

            </div>
        </main>

        <footer class="main-footer">
             <p>&copy; 2025 Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
        </footer>

    </div>

    <script>
        // --- Firebase Config (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const firebaseConfig = {
            apiKey: "AIzaSyDuUebu7Qzz3JnTfa-58EIPZjOcrkmdGHU",
            authDomain: "quranplan2.firebaseapp.com",
            projectId: "quranplan2",
            storageBucket: "quranplan2.appspot.com",
            messagingSenderId: "1098692856811",
            appId: "1:1098692856811:web:923bca3a54fd78b1b267ae"
        };

        // --- Initialize Firebase (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
         try { firebase.initializeApp(firebaseConfig); } catch (e) { console.error("Firebase initialization error:", e); }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- DOM References (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const loadingIndicator = document.getElementById('loading-indicator');
        const dashboardContent = document.getElementById('dashboard-content');
        const dailyTaskContent = document.getElementById('daily-task-content');
        const currentPlanNameSpan = document.getElementById('current-plan-name');
        const progressBarValue = document.getElementById('progress-bar-value');
        const completedPagesProgressSpan = document.getElementById('completed-pages-progress');
        const statMemorized = document.getElementById('stat-memorized');
        const statPerfected = document.getElementById('stat-perfected');
        const statLinked = document.getElementById('stat-linked');
        const statExcuses = document.getElementById('stat-excuses');
        const todayDateSpan = document.getElementById('today-date-display');
        const calendarContainer = document.getElementById('calendar-container'); // Ù…Ø±Ø¬Ø¹ Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
        const currentStreakSpan = document.getElementById('current-streak');
        const longestStreakSpan = document.getElementById('longest-streak');
        const levelTitleSpan = document.getElementById('level-title');
        const levelIconSpan = document.getElementById('level-icon');

        // --- Constants (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const totalQuranPages = 604;
        const initialTotalRows = 320;

        // --- Global State (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        let currentUser = null;
        let currentPlanData = null;
        // let calendarInstance = null; // Ù…ØªØºÙŠØ± Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…

        // --- Data Arrays & Helper Functions (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const surahs = ['Ø§Ù„ÙØ§ØªØ­Ø© ÙˆØ§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø© ÙˆØ¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡ ÙˆØ§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø© ÙˆØ§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø© ÙˆÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³ ÙˆÙ‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯ ÙˆÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙˆØ§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø± ÙˆØ§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„ ÙˆØ§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡ ÙˆØ§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ… ÙˆØ·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡ ÙˆØ§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡ ÙˆØ§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬ ÙˆØ§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ† ÙˆØ§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ± ÙˆØ§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„ ÙˆØ§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª ÙˆØ§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ù„Ù‚Ù…Ø§Ù†', 'Ù„Ù‚Ù…Ø§Ù†', 'Ø§Ù„Ø³Ø¬Ø¯Ø©', 'Ø§Ù„Ø³Ø¬Ø¯Ø© ÙˆØ§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨ ÙˆØ³Ø¨Ø£', 'Ø³Ø¨Ø£', 'Ø³Ø¨Ø£', 'Ø³Ø¨Ø£ ÙˆÙØ§Ø·Ø±', 'ÙØ§Ø·Ø±', 'ÙØ§Ø·Ø±', 'ÙØ§Ø·Ø± ÙˆÙŠØ³', 'ÙŠØ³', 'ÙŠØ³', 'ÙŠØ³ ÙˆØ§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Øµ', 'Øµ', 'Øµ ÙˆØ§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ÙØµÙ„Øª', 'ÙØµÙ„Øª', 'ÙØµÙ„Øª', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰ ÙˆØ§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù ÙˆØ§Ù„Ø¯Ø®Ø§Ù†', 'Ø§Ù„Ø¯Ø®Ø§Ù†', 'Ø§Ù„Ø¬Ø§Ø«ÙŠØ©', 'Ø§Ù„Ø¬Ø§Ø«ÙŠØ© ÙˆØ§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ø§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ø§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ù…Ø­Ù…Ø¯', 'Ù…Ø­Ù…Ø¯', 'Ø§Ù„ÙØªØ­', 'Ø§Ù„ÙØªØ­', 'Ø§Ù„ÙØªØ­ ÙˆØ§Ù„Ø­Ø¬Ø±Ø§Øª', 'Ø§Ù„Ø­Ø¬Ø±Ø§Øª Ùˆ Ù‚', 'Ù‚', 'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª', 'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª ÙˆØ§Ù„Ø·ÙˆØ±', 'Ø§Ù„Ø·ÙˆØ± ÙˆØ§Ù„Ù†Ø¬Ù…', 'Ø§Ù„Ù†Ø¬Ù… ÙˆØ§Ù„Ù‚Ù…Ø±', 'Ø§Ù„Ù‚Ù…Ø±', 'Ø§Ù„Ù‚Ù…Ø± ÙˆØ§Ù„Ø±Ø­Ù…Ù†', 'Ø§Ù„Ø±Ø­Ù…Ù† ÙˆØ§Ù„ÙˆØ§Ù‚Ø¹Ø©', 'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©', 'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ¯', 'Ø§Ù„Ø­Ø¯ÙŠØ¯', 'Ø§Ù„Ø­Ø¯ÙŠØ¯ ÙˆØ§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©', 'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©', 'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø© ÙˆØ§Ù„Ø­Ø´Ø±', 'Ø§Ù„Ø­Ø´Ø±', 'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©', 'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø© ÙˆØ§Ù„ØµÙ', 'Ø§Ù„Ø¬Ù…Ø¹Ø© ÙˆØ§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†', 'Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ† ÙˆØ§Ù„ØªØºØ§Ø¨Ù†', 'Ø§Ù„ØªØºØ§Ø¨Ù† ÙˆØ§Ù„Ø·Ù„Ø§Ù‚', 'Ø§Ù„Ø·Ù„Ø§Ù‚ ÙˆØ§Ù„ØªØ­Ø±ÙŠÙ…', 'Ø§Ù„ØªØ­Ø±ÙŠÙ… ÙˆØ§Ù„Ù…Ù„Ùƒ', 'Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ù‚Ù„Ù…', 'Ø§Ù„Ù‚Ù„Ù… ÙˆØ§Ù„Ø­Ø§Ù‚Ø©', 'Ø§Ù„Ø­Ø§Ù‚Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ø±Ø¬', 'Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬ ÙˆÙ†ÙˆØ­', 'Ù†ÙˆØ­ ÙˆØ§Ù„Ø¬Ù†', 'Ø§Ù„Ø¬Ù† ÙˆØ§Ù„Ù…Ø²Ù…Ù„', 'Ø§Ù„Ù…Ø²Ù…Ù„ ÙˆØ§Ù„Ù…Ø¯Ø«Ø±', 'Ø§Ù„Ù…Ø¯Ø«Ø± ÙˆØ§Ù„Ù‚ÙŠØ§Ù…Ø© ÙˆØ§Ù„Ø¥Ù†Ø³Ø§Ù†', 'Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ÙˆØ§Ù„Ù…Ø±Ø³Ù„Ø§Øª', 'Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª ÙˆØ§Ù„Ù†Ø¨Ø£', 'Ø§Ù„Ù†Ø¨Ø£ ÙˆØ§Ù„Ù†Ø§Ø²Ø¹Ø§Øª', 'Ø¹Ø¨Ø³ ÙˆØ§Ù„ØªÙƒÙˆÙŠØ±', 'Ø§Ù„Ø¥Ù†ÙØ·Ø§Ø± ÙˆØ§Ù„Ù…Ø·ÙÙÙŠÙ†', 'Ø§Ù„Ø¥Ù†Ø´Ù‚Ø§Ù‚ ÙˆØ§Ù„Ø¨Ø±ÙˆØ¬', 'Ø§Ù„Ø·Ø§Ø±Ù‚ ÙˆØ§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ§Ù„ØºØ§Ø´ÙŠØ©', 'Ø§Ù„ÙØ¬Ø± ÙˆØ§Ù„Ø¨Ù„Ø¯', 'Ø§Ù„Ø´Ù…Ø³ ÙˆØ§Ù„Ù„ÙŠÙ„', 'Ø§Ù„Ø¶Ø­Ù‰ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§Ø³', 'Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†'];
        const linkFromData = ['', '', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 13, 13, 13, 13, 13, 13, 25, 25, 25, 25, 25, 25, 37, 37, 37, 37, 37, 37, 49, 49, 49, 49, 49, 49, 61, 61, 61, 61, 61, 61, 73, 73, 73, 73, 73, 73, 85, 85, 85, 85, 85, 85, 97, 97, 97, 97, 97, 97, 109, 109, 109, 109, 109, 109, 121, 121, 121, 121, 121, 121, 133, 133, 133, 133, 133, 133, 145, 145, 145, 145, 145, 145, 157, 157, 157, 157, 157, 157, 169, 169, 169, 169, 169, 169, 181, 181, 181, 181, 181, 181, 193, 193, 193, 193, 193, 193, 205, 205, 205, 205, 205, 205, 217, 217, 217, 217, 217, 217, 229, 229, 229, 229, 229, 229, 241, 241, 241, 241, 241, 241, 253, 253, 253, 253, 253, 253, 265, 265, 265, 265, 265, 265, 277, 277, 277, 277, 277, 277, 289, 289, 289, 289, 289, 289, 301, 301, 301, 301, 301, 301, 313, 313, 313, 313, 313, 313, 325, 325, 325, 325, 325, 325, 337, 337, 337, 337, 337, 337, 349, 349, 349, 349, 349, 349, 361, 361, 361, 361, 361, 361, 373, 373, 373, 373, 373, 373, 385, 385, 385, 385, 385, 385, 397, 397, 397, 397, 397, 397, 409, 409, 409, 409, 409, 409, 421, 421, 421, 421, 421, 421, 433, 433, 433, 433, 433, 433, 445, 445, 445, 445, 445, 445, 457, 457, 457, 457, 457, 457, 469, 469, 469, 469, 469, 469, 481, 481, 481, 481, 481, 481, 493, 493, 493, 493, 493, 493, 505, 505, 505, 505, 505, 505, 517, 517, 517, 517, 517, 517, 529, 529, 529, 529, 529, 529, 541, 541, 541, 541, 541, 541, 553, 553, 553, 553, 553, 553, 565, 565, 565, 565, 565, 565, 577, 577, 577, 577, 577, 577];
        const linkToData = ['', '', 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 510, 512, 514, 516, 518, 520, 522, 524, 526, 528, 530, 532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552, 554, 556, 558, 560, 562, 564, 566, 568, 570, 572, 574, 576, 578, 580, 582, 584, 586, 588, 590, 592, 594, 597, 600, 604];
        const reviewFromData = [...Array(32).fill(''), 1, 3, 5, 7, 9, 11, 1, 5, 9, 13, 17, 21, 1, 7, 13, 19, 25, 31, 1, 9, 17, 25, 33, 41, 1, 11, 21, 31, 41, 51, 1, 13, 25, 37, 49, 61, 1, 15, 29, 43, 57, 71, 1, 17, 33, 49, 65, 81, 1, 19, 37, 55, 73, 91, 1, 21, 41, 61, 81, 101, 1, 23, 45, 67, 89, 111, 1, 25, 49, 73, 97, 121, 1, 27, 53, 79, 105, 131, 1, 29, 57, 85, 113, 141, 1, 31, 61, 91, 121, 151, 1, 33, 65, 97, 129, 161, 1, 35, 69, 103, 137, 171, 1, 37, 73, 109, 145, 181, 1, 39, 77, 115, 153, 191, 1, 41, 81, 121, 161, 201, 1, 43, 85, 127, 169, 211, 1, 45, 89, 133, 177, 221, 1, 47, 93, 139, 185, 231, 1, 49, 97, 145, 193, 241, 1, 51, 101, 151, 201, 251, 1, 53, 105, 157, 209, 261, 1, 55, 109, 163, 217, 271, 1, 57, 113, 169, 225, 281, 1, 59, 117, 175, 233, 291, 1, 61, 121, 181, 241, 301, 1, 63, 125, 187, 249, 311, 1, 65, 129, 193, 257, 321, 1, 67, 133, 199, 265, 331, 1, 69, 137, 205, 273, 341, 1, 71, 141, 211, 281, 351, 1, 73, 145, 217, 289, 361, 1, 75, 149, 223, 297, 371, 1, 77, 153, 229, 305, 381, 1, 79, 157, 235, 313, 391, 1, 81, 161, 241, 321, 401, 1, 83, 165, 247, 329, 411, 1, 85, 169, 253, 337, 421, 1, 87, 173, 259, 345, 431, 1, 89, 177, 265, 353, 441, 1, 91, 181, 271, 361, 451, 1, 93, 185, 277, 369, 461, 1, 95, 189, 283, 377, 471, 1, 97, 193, 289, 385, 481];
        const reviewToData = [...Array(32).fill(''), 2, 4, 6, 8, 10, 12, 4, 8, 12, 16, 20, 24, 6, 12, 18, 24, 30, 36, 8, 16, 24, 32, 40, 48, 10, 20, 30, 40, 50, 60, 12, 24, 36, 48, 60, 72, 14, 28, 42, 56, 70, 84, 16, 32, 48, 64, 80, 96, 18, 36, 54, 72, 90, 108, 20, 40, 60, 80, 100, 120, 22, 44, 66, 88, 110, 132, 24, 48, 72, 96, 120, 144, 26, 52, 78, 104, 130, 156, 28, 56, 84, 112, 140, 168, 30, 60, 90, 120, 150, 180, 32, 64, 96, 128, 160, 192, 34, 68, 102, 136, 170, 204, 36, 72, 108, 144, 180, 216, 38, 76, 114, 152, 190, 228, 40, 80, 120, 160, 200, 240, 42, 84, 126, 168, 210, 252, 44, 88, 132, 176, 220, 264, 46, 92, 138, 184, 230, 276, 48, 96, 144, 192, 240, 288, 50, 100, 150, 200, 250, 300, 52, 104, 156, 208, 260, 312, 54, 108, 162, 216, 270, 324, 56, 112, 168, 224, 280, 336, 58, 116, 174, 232, 290, 348, 60, 120, 180, 240, 300, 360, 62, 124, 186, 248, 310, 372, 64, 128, 192, 256, 320, 384, 66, 132, 198, 264, 330, 396, 68, 136, 204, 272, 340, 408, 70, 140, 210, 280, 350, 420, 72, 144, 216, 288, 360, 432, 74, 148, 222, 296, 370, 444, 76, 152, 228, 304, 380, 456, 78, 156, 234, 312, 390, 468, 80, 160, 240, 320, 400, 480, 82, 164, 246, 328, 410, 492, 84, 168, 252, 336, 420, 504, 86, 172, 258, 344, 430, 516, 88, 176, 264, 352, 440, 528, 90, 180, 270, 360, 450, 540, 92, 184, 276, 368, 460, 552, 94, 188, 282, 376, 470, 564, 96, 192, 288, 384, 480, 576];

        // --- *** ØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù‡Ù†Ø§ *** ---
        function formatDate(date) { if (!(date instanceof Date)) date = new Date(date); if (isNaN(date.getTime())) return ""; const year = date.getFullYear(); const month = String(date.getMonth() + 1).padStart(2, '0'); const day = String(date.getDate()).padStart(2, '0'); return `${year}-${month}-${day}`; }
        function getPlanData(originalIndex) { const index = parseInt(originalIndex); if (isNaN(index) || index < 0 || index >= initialTotalRows) { return null; } let fromPage = '', toPage = ''; if (index < 299) { fromPage = index * 2 + 1; toPage = fromPage + 1; } else if (index === 299) { fromPage = 601; toPage = 604; } return { fromPage: fromPage, toPage: toPage, surah: surahs[index] || '', linkFrom: linkFromData[index] ?? '', linkTo: linkToData[index] ?? '', reviewFrom: reviewFromData[index] ?? '', reviewTo: reviewToData[index] ?? '', round: calculateRoundNumber(index) }; }
        function calculateRoundNumber(originalIndex) { if (originalIndex < 32 || !reviewFromData || reviewFromData[originalIndex] == null || reviewFromData[originalIndex] === '') { return ''; } let reviewDataStartIndex = 32; let reviewCounter = 0; for(let i = reviewDataStartIndex; i <= originalIndex; i++){ if(reviewFromData[i] != null && reviewFromData[i] !== '') reviewCounter++; } if (reviewCounter === 0) return ''; return Math.ceil(reviewCounter / 6); }

        // --- UI Update Functions (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        function showLoading(message = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...") { if(loadingIndicator){ loadingIndicator.textContent = message; loadingIndicator.style.display = 'block';} if(dashboardContent) dashboardContent.style.display = 'none'; }
        function hideLoading() { if(loadingIndicator) loadingIndicator.style.display = 'none'; }
        function displayDashboard() { hideLoading(); if(dashboardContent) dashboardContent.style.display = 'block'; }

        // --- Functions to Calculate Stats (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        function calculateDashboardStats(tableRows) {
            let lastCompletedPage = 0; let linkedTasks = 0; let perfectedTasks = 0; let excuseCount = 0;
            if (!tableRows) return { memorizedPages: 0, linkedTasks: 0, perfectedTasks: 0, excuseCount: 0 };
            tableRows.forEach(row => {
                if (row.type === 'excuse') { excuseCount++; }
                else if (row.type === 'plan' && row.state?.completed) { // Use optional chaining
                    // *** Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† getPlanData Ù…Ø¹Ø±ÙØ© Ù‚Ø¨Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¦Ù‡Ø§ ***
                    const planInfo = typeof getPlanData === 'function' ? getPlanData(row.originalSequence) : null;
                    if (planInfo && planInfo.toPage) { const pageNum = parseInt(planInfo.toPage); if (!isNaN(pageNum)) { lastCompletedPage = Math.max(lastCompletedPage, pageNum); } }
                    if (planInfo && planInfo.linkTo !== '' && row.state?.linked) { linkedTasks++; } // Optional chaining
                    if (planInfo && planInfo.reviewTo !== '' && row.state?.reviewed) { perfectedTasks++; } // Optional chaining
                }
            });
            const memorizedPages = Math.min(lastCompletedPage, totalQuranPages);
            return { memorizedPages: memorizedPages, linkedTasks: linkedTasks, perfectedTasks: perfectedTasks, excuseCount: excuseCount };
        }

        // --- Streak, Level Functions (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const levelTitles = [ "Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ!", "ğŸŒ± ØºØ±Ø³Ø© Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†", "âœ¨ Ø¨Ø§Ø¯Ø±Ø© Ø£Ù…Ù„", "ğŸƒ Ø³Ø§Ø¹Ù Ù„Ù„Ø¹Ù„Ø§", "â­ Ù†Ø¬Ù… ØµØ§Ø¹Ø¯", "ğŸ’ª Ù…Ø«Ø§Ø¨Ø± Ù…Ø¬ØªÙ‡Ø¯", "ğŸ§­ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¨", "ğŸ’¯ ØµØ§Ø­Ø¨ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†", "ğŸš€ Ø§Ù†Ø·Ù„Ø§Ù‚Ø© Ù‚ÙˆÙŠØ©", "ğŸ’ Ø¬ÙˆÙ‡Ø±Ø© Ù…ØµÙ‚ÙˆÙ„Ø©", "ğŸ‘‘ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø¦Ø© ÙŠÙˆÙ…", "ğŸ“– Ø±ÙÙŠÙ‚ Ø§Ù„Ù‚Ø±Ø¢Ù†", "ğŸ•¯ï¸ Ù…Ù†Ø§Ø±Ø© Ù‡Ø¯Ù‰", "ğŸ”ï¸ Ù‚Ù…Ø© Ø´Ø§Ù…Ø®Ø©", "ğŸŒ³ Ø´Ø¬Ø±Ø© Ø·ÙŠØ¨Ø©", "â³ Ø¹Ø§Ø¨Ø± Ù…Ù†ØªØµÙ Ø§Ù„Ø·Ø±ÙŠÙ‚", "ğŸ¯ Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ²Ø§Ù…", "ğŸŒŠ Ø¨Ø­Ø± Ø²Ø§Ø®Ø±", "ğŸŒŸ ÙƒÙˆÙƒØ¨ Ø¯Ø±ÙŠ", "ğŸ§­ Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ø­Ù‚", "ğŸ’¯ğŸ’¯ Ø§Ù„Ù…Ø¦ØªØ§Ù† Ù„Ø§ ØªÙ‚ÙØ§Ù†!", "ğŸ¤² Ù‚Ù„Ø¨ Ø®Ø§Ø´Ø¹", "ğŸ•Šï¸ Ø±ÙˆØ­ Ù…Ø·Ù…Ø¦Ù†Ø©", "ğŸ’– Ù…Ø­Ø¨ Ù„Ù„Ø±Ø­Ù…Ù†", "ğŸ™ Ø¹Ø¨Ø¯ Ø´ÙƒÙˆØ±", "ğŸ’¡ Ø¨ØµÙŠØ±Ø© Ù†Ø§ÙØ°Ø©", "ğŸ•Œ Ù…Ø¹Ù…Ù‘Ø± Ø¨ÙŠÙˆØª Ø§Ù„Ù„Ù‡", "ğŸŒ™ Ù‡Ù„Ø§Ù„ Ø§Ù„ÙƒÙ…Ø§Ù„", "âœ¨ Ù†ÙˆØ± Ø¹Ù„Ù‰ Ù†ÙˆØ±", "ğŸ Ù‚Ø§Ø¨ Ù‚ÙˆØ³ÙŠÙ† Ø£Ùˆ Ø£Ø¯Ù†Ù‰", "ğŸ† ÙØ§Ø±Ø³ Ø§Ù„Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©", "ğŸ‰ Ù…Ù‚ØªØ±Ø¨ Ù…Ù† Ø§Ù„Ø®ØªØ§Ù…", "ğŸŠ Ø®Ø§ØªÙ… Ù…Ø¨Ø§Ø±Ùƒ" ];
        const levelIcons = { 10: 'ğŸ‘‘', 20: 'ğŸ’¯', 30: 'ğŸ†', 32: 'ğŸŠ' };
        function calculateStreaksAndLevel(tableRows) {
            if (!tableRows || tableRows.length === 0) { return { currentStreak: 0, longestStreak: 0, currentLevel: 0, currentTitle: levelTitles[0], currentIcon: '' }; }
            const sortedRows = [...tableRows].sort((a, b) => new Date(a.displayDate) - new Date(b.displayDate));
            let currentStreak = 0; let longestStreak = 0; let currentRun = 0; const todayStr = formatDate(new Date()); let isStreakActiveToday = false;
            for (const row of sortedRows) { if (row.displayDate > todayStr) break; if (row.type === 'plan' && row.state?.completed) { currentRun++; if(row.displayDate === todayStr) { isStreakActiveToday = true; } } else if (row.type === 'excuse') { if (currentRun > longestStreak) { longestStreak = currentRun; } if(row.displayDate === todayStr){ isStreakActiveToday = false; } } else { if (currentRun > longestStreak) { longestStreak = currentRun; } currentRun = 0; isStreakActiveToday = false; } }
            if (currentRun > longestStreak) { longestStreak = currentRun; }
            if (isStreakActiveToday || (sortedRows.length > 0 && sortedRows[sortedRows.length-1].type === 'plan' && sortedRows[sortedRows.length-1].state?.completed && sortedRows[sortedRows.length-1].displayDate < todayStr)) { let tempCurrentStreak = 0; for (let i = sortedRows.length - 1; i >= 0; i--) { const row = sortedRows[i]; if (row.displayDate > todayStr) continue; if (row.type === 'plan' && row.state?.completed) { tempCurrentStreak++; } else if (row.type === 'excuse') { continue; } else { break; } } currentStreak = tempCurrentStreak; } else { currentStreak = 0; }
            const levelIndex = Math.min(Math.floor(currentStreak / 10), levelTitles.length - 1); const currentTitle = levelTitles[levelIndex] || levelTitles[0]; const currentIcon = levelIcons[levelIndex] || '';
            return { currentStreak: currentStreak, longestStreak: longestStreak, currentLevel: levelIndex, currentTitle: currentTitle, currentIcon: currentIcon };
        }

        // --- *** START: Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªÙ‚ÙˆÙŠÙ… (jsCalendar + Ø§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„ÙŠØ¯ÙˆÙŠ) *** ---

        // --- Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ„ÙˆÙŠÙ† ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ---
        function applyCustomHighlights(tableRows) {
            console.log("Applying jsCalendar highlights manually...");
            const calendarContainer = document.getElementById('calendar-container'); // Ù†Ø­ØªØ§Ø¬ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙˆÙŠØ© Ù‡Ù†Ø§ Ø£ÙŠØ¶Ù‹Ø§
            if (!calendarContainer || !tableRows) {
                console.log("Cannot apply highlights: Missing container or tableRows.");
                return;
            }

            // --- ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« ---
            const dayStatus = {};
            tableRows.forEach(row => {
                if (row.displayDate) {
                    if (row.type === 'plan' && row.state?.completed) { dayStatus[row.displayDate] = 'completed'; }
                    else if (row.type === 'excuse') { dayStatus[row.displayDate] = 'excused'; }
                }
            });
            // console.log("Manual highlight lookup data:", dayStatus); // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù„Ù„ØªØ­Ù‚Ù‚

            // --- Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£ÙŠØ§Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ---
            // Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ù‡Ùˆ '.jsCalendar-day-number' ÙÙŠ Ù…ÙƒØªØ¨Ø© jsCalendar
            const dayElements = calendarContainer.querySelectorAll('.jsCalendar-day-number');
            console.log(`Found ${dayElements.length} jsCalendar day elements to check for manual highlighting.`);

            dayElements.forEach(element => {
                // Ø§Ù„ØªØ§Ø±ÙŠØ® ÙŠÙƒÙˆÙ† ÙÙŠ Ø®Ø§ØµÙŠØ© 'data-date'
                const date = element.dataset.date;
                // --- Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ø³Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø§Ù„ØªØ±Ø§ÙƒÙ… ---
                element.classList.remove('day-completed', 'day-excused');
                // --- Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© ---
                if (date && dayStatus[date]) { // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ù„ØªØ§Ø±ÙŠØ® Ø­Ø§Ù„Ø© Ù…Ø³Ø¬Ù„Ø© Ù„Ø¯ÙŠÙ†Ø§
                    const status = dayStatus[date];
                    if (status === 'completed') {
                        element.classList.add('day-completed'); // Ø£Ø¶Ù ÙƒÙ„Ø§Ø³ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²
                    } else if (status === 'excused') {
                        element.classList.add('day-excused'); // Ø£Ø¶Ù ÙƒÙ„Ø§Ø³ Ø§Ù„Ø¹Ø°Ø±
                    }
                }
            });
            console.log("Finished applying jsCalendar highlights.");
            // ØªØ°ÙƒÙŠØ± Ø¨Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† CSS Ø¥Ø°Ø§ Ù„Ù… ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù†
            console.warn("If colors don't appear, ensure CSS rules target the element directly, e.g., .jsCalendar-day-number.day-completed");
        }

        // --- Ø¯Ø§Ù„Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… jsCalendar ÙˆØ§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„ÙŠØ¯ÙˆÙŠ) ---
        function initializeCalendar(tableRows) {
            console.log("Initializing jsCalendar, highlights will be applied AFTER init manually...");
            const calendarContainer = document.getElementById('calendar-container'); // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
            if (!calendarContainer) {
                console.error("Calendar container element not found!");
                return;
            }
            calendarContainer.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¤Ù‚Øª

            const today = new Date();

            // --- ØªÙ‡ÙŠØ¦Ø© jsCalendar Ø¨Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ---
            try {
                 // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù‡Ø¯Ù ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡
                 const targetElement = calendarContainer;

                 // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… new
                 // *** ØªÙ… ØªØµØ­ÙŠØ­ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… new ***
                 const calendarInstance = new jsCalendar(targetElement, today, {
                      language: 'ar', // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                      monthFormat: 'MMMM<y_bin_46>' // <<== ØªÙ… ØªØµØ­ÙŠØ­ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù‡Ù†Ø§ Ø£ÙŠØ¶Ù‹Ø§
                 });

                 // jsCalendar v1.x Ù„Ø§ ØªØ­ØªØ§Ø¬ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ .init() Ù…Ù†ÙØµÙ„ Ø¹Ø§Ø¯Ø©Ù‹
                 console.log("jsCalendar initialized successfully (using new).");

                 // --- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù…Ø¹ ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· ---
                 // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù†ØªÙ‡Øª ØªÙ…Ø§Ù…Ù‹Ø§ Ù…Ù† Ø±Ø³Ù… Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙÙŠ Ø§Ù„ØµÙØ­Ø©
                 setTimeout(() => {
                     // Ù†Ù…Ø±Ø± tableRows Ù„Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ¹Ø±Ù Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙŠØ§Ù…
                     applyCustomHighlights(tableRows);
                 }, 150); // ØªØ£Ø®ÙŠØ± 150 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©

            } catch (error) {
                console.error("Error initializing jsCalendar:", error);
                calendarContainer.innerHTML = `<p class="text" style="color:red;">Error loading calendar. (${error.message})</p>`;
            }
        }
        // --- *** END: Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªÙ‚ÙˆÙŠÙ… *** ---


        // --- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø®Ø±Ù‰ (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        function displayDailyTask() {
            if (!dailyTaskContent || !currentPlanData || !currentPlanData.tableRows) { if(dailyTaskContent) dailyTaskContent.innerHTML = '<p><i>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·Ø©...</i></p>'; if (todayDateSpan) todayDateSpan.textContent = formatDate(new Date()); return; }
            const tableRows = currentPlanData.tableRows; const today = new Date(); const todayStr = formatDate(today); if (todayDateSpan) todayDateSpan.textContent = todayStr; const todayRow = tableRows.find(row => row.displayDate === todayStr);
            if (!todayRow) { dailyTaskContent.innerHTML = '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨ Ù…Ù‚Ø±Ø± ÙÙŠ Ø§Ù„Ø®Ø·Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….</p>'; } else if (todayRow.type === 'excuse') { dailyTaskContent.innerHTML = `<p style="color: orange; font-weight:bold;">Ù„Ø¯ÙŠÙƒ Ø¹Ø°Ø± Ù…Ø³Ø¬Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… (${todayRow.excuseType || ''}).</p>`; } else if (todayRow.type === 'plan' && todayRow.state?.completed) { dailyTaskContent.innerHTML = '<p style="color: green; font-weight: bold;">âœ… Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª ÙˆØ§Ø¬Ø¨ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…!</p>'; } else if (todayRow.type === 'plan' && !todayRow.state?.completed) {
                // *** Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† getPlanData Ù…Ø¹Ø±ÙØ© Ù‚Ø¨Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¦Ù‡Ø§ ***
                const taskDetails = typeof getPlanData === 'function' ? getPlanData(todayRow.originalSequence) : null;
                if (taskDetails) { let taskHTML = `<h4>Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¥Ù†Ø¬Ø§Ø²Ù‡ Ø§Ù„ÙŠÙˆÙ… (${todayStr}):</h4>`; taskHTML += `<p><strong>Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</strong> ${taskDetails.fromPage ? `Øµ ${taskDetails.fromPage} - ${taskDetails.toPage}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'} (${taskDetails.surah || 'Ù…Ø±Ø§Ø¬Ø¹Ø©'})</p>`; taskHTML += `<p><strong>Ø§Ù„Ø±Ø¨Ø·:</strong> ${taskDetails.linkFrom ? `Ù…Ù† ${taskDetails.linkFrom} Ø¥Ù„Ù‰ ${taskDetails.linkTo}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>`; taskHTML += `<p><strong>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</strong> ${taskDetails.reviewFrom ? `Ù…Ù† ${taskDetails.reviewFrom} Ø¥Ù„Ù‰ ${taskDetails.reviewTo}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'} ${taskDetails.round ? `(Ø¬${taskDetails.round})` : ''}</p>`; dailyTaskContent.innerHTML = taskHTML; } else { dailyTaskContent.innerHTML = `<p><i>Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù„Ù„ÙÙ‡Ø±Ø³ ${todayRow.originalSequence}.</i></p>`; } } else { dailyTaskContent.innerHTML = '<p><i>ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙŠÙˆÙ… Ù„Ù… ÙŠÙƒØªÙ…Ù„ Ø¨Ø¹Ø¯ Ø£Ùˆ Ø­Ø§Ù„ØªÙ‡ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©.</i></p>'; }
        }
        function displayProgress(stats) { if (!currentPlanData) return; const planType = currentPlanData.planType || '?'; const memorizedPages = stats.memorizedPages; const progressPercent = totalQuranPages > 0 ? Math.min(100, (memorizedPages / totalQuranPages) * 100).toFixed(0) : 0; if(currentPlanNameSpan) currentPlanNameSpan.textContent = `Ø®Ø·Ø© ${planType} ØµÙØ­Ø§Øª`; if(progressBarValue) { progressBarValue.style.width = `${progressPercent}%`; progressBarValue.style.backgroundColor = '#28a745'; progressBarValue.textContent = `${progressPercent}%`; } if(completedPagesProgressSpan) completedPagesProgressSpan.textContent = memorizedPages; }
        function displayStats(stats) { if(statMemorized) statMemorized.textContent = stats.memorizedPages; if(statPerfected) statPerfected.textContent = stats.perfectedTasks; if(statLinked) statLinked.textContent = stats.linkedTasks; if(statExcuses) statExcuses.textContent = stats.excuseCount; }
        function displayStreakAndLevel(streakData) { if(currentStreakSpan) currentStreakSpan.textContent = streakData.currentStreak; if(longestStreakSpan) longestStreakSpan.textContent = streakData.longestStreak; if(levelTitleSpan) levelTitleSpan.textContent = streakData.currentTitle; if(levelIconSpan) levelIconSpan.textContent = streakData.currentIcon; }

        // --- Main Data Loading Function (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠØŒ ØªØ³ØªØ¯Ø¹ÙŠ initializeCalendar Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©) ---
        function loadDashboardData(user) {
            if (!user) return;
            const uid = user.uid;
            const planRef = db.collection("quranPlans").doc(uid);
            console.log("Dashboard: Checking Firestore for plan:", uid);
            showLoading("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø·ØªÙƒ...");
            planRef.get().then((doc) => {
                hideLoading();
                if (doc.exists) {
                    console.log("Dashboard: Plan data found.");
                    currentPlanData = doc.data();
                    if (!currentPlanData.startDate || !currentPlanData.planType || !currentPlanData.tableRows || !Array.isArray(currentPlanData.tableRows) || !currentPlanData.repetitionMax) {
                         console.error("Loaded data missing required fields.");
                         dashboardContent.style.display = 'block';
                         dailyTaskContent.innerHTML = `<p style="color:red; font-weight:bold;">Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø·ØªÙƒ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø© Ø£Ùˆ ØªØ§Ù„ÙØ©. ÙŠØ±Ø¬Ù‰ <a href="index.html">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</a> ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø©.</p>`;
                         const sectionsToHide = ['plan-progress', 'quick-stats', 'calendar-view', 'streak-level'];
                         sectionsToHide.forEach(id => { const el = document.getElementById(id); if(el) el.style.display = 'none'; });
                         return;
                     }
                    // Process Data & Update UI
                    // *** Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ø¹Ø±ÙØ© Ù‚Ø¨Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¦Ù‡Ø§ ***
                    const stats = typeof calculateDashboardStats === 'function' ? calculateDashboardStats(currentPlanData.tableRows) : { memorizedPages: 0, linkedTasks: 0, perfectedTasks: 0, excuseCount: 0 };
                    const streakData = typeof calculateStreaksAndLevel === 'function' ? calculateStreaksAndLevel(currentPlanData.tableRows) : { currentStreak: 0, longestStreak: 0, currentLevel: 0, currentTitle: levelTitles[0], currentIcon: '' };

                    if (typeof displayDailyTask === 'function') displayDailyTask(); else console.error("displayDailyTask is not defined");
                    if (typeof displayProgress === 'function') displayProgress(stats); else console.error("displayProgress is not defined");
                    if (typeof displayStats === 'function') displayStats(stats); else console.error("displayStats is not defined");
                    if (typeof displayStreakAndLevel === 'function') displayStreakAndLevel(streakData); else console.error("displayStreakAndLevel is not defined");
                    if (typeof initializeCalendar === 'function') initializeCalendar(currentPlanData.tableRows); // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                    else console.error("initializeCalendar function is not defined!");

                    if (typeof displayDashboard === 'function') displayDashboard(); else console.error("displayDashboard function is not defined!");

                } else {
                     // No plan found logic
                     console.log("Dashboard: No plan data found.");
                     if (typeof displayDashboard === 'function') displayDashboard();
                     if(dailyTaskContent) dailyTaskContent.innerHTML = '<p style="color:orange; font-weight:bold;">Ù„Ù… ØªÙ‚Ù… Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¨Ø¹Ø¯!</p><p>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ <a href="index.html">ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</a> Ù„Ø§Ø®ØªÙŠØ§Ø± Ø®Ø·ØªÙƒ.</p>';
                     const sectionsToHide = ['plan-progress', 'quick-stats', 'calendar-view', 'streak-level', 'competition-section', 'badges-section'];
                     sectionsToHide.forEach(id => { const el = document.getElementById(id); if(el) el.style.display = 'none'; });
                 }
            }).catch((error) => {
                 // Error handling
                 console.error("Error getting plan document:", error); // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ÙØ¹Ù„ÙŠ Ù‡Ù†Ø§
                 hideLoading();
                 if (typeof displayDashboard === 'function') displayDashboard();
                 // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ØªÙŠ Ø±Ø¢Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                 if(dailyTaskContent) dailyTaskContent.innerHTML = `<p style="color:red; font-weight:bold;">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·Ø©. (${error.code || error.message || 'UNKNOWN'})</p><p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Firestore. <a href="index.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></p>`;
                 const sectionsToHide = ['plan-progress', 'quick-stats', 'calendar-view', 'streak-level', 'competition-section', 'badges-section'];
                 sectionsToHide.forEach(id => { const el = document.getElementById(id); if(el) el.style.display = 'none'; });
            });
        }

        // --- Authentication Listener (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        auth.onAuthStateChanged(user => {
           hideLoading();
           currentUser = user;
           if (user) {
               console.log("Dashboard: Auth state OK.");
               loadDashboardData(user);
           } else {
               console.log("Dashboard: Not logged in.");
                showLoading("ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
                console.warn("User not logged in, dashboard will not load data.");
                if(dashboardContent) dashboardContent.style.display = 'block';
                if(dailyTaskContent) dailyTaskContent.innerHTML = '<p style="color:red;">ÙŠØ±Ø¬Ù‰ <a href="index.html">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a> Ù„Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.</p>';
                const sectionsToHide = ['plan-progress', 'quick-stats', 'calendar-view', 'streak-level', 'competition-section', 'badges-section'];
                sectionsToHide.forEach(id => { const section = document.getElementById(id); if (section) section.style.display = 'none'; });
           }
        });

        // --- Initial Load (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        document.addEventListener('DOMContentLoaded', () => {
            showLoading("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...");
        });

         // --- Print Function (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
         function printData() { console.log("Initiating browser print..."); window.print(); }

    </script>

</body>
</html>
