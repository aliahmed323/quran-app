<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© - Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vanilla-calendar-pro/build/vanilla-calendar.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vanilla-calendar-pro/build/vanilla-calendar.min.js" defer></script>

    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore-compat.js"></script>

    <style>
        /* --- CSS Styles (ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø·ÙÙŠÙØ© ÙˆØ¥Ø¶Ø§ÙØ§Øª Ù„Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØ§Ù„Ù€ Streak) --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f4f7f6; color: #333; line-height: 1.7; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }
        h1, h2, h3, h4 { color: #1a5276; margin-bottom: 0.75em; }
        p { margin-bottom: 1em; color: #555; font-size: 0.95em; }
        a { text-decoration: none; color: #2980b9; }
        .card { background-color: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 3px 6px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; }

        /* --- Header --- */
        .dashboard-header { display: flex; justify-content: center; align-items: center; padding: 10px 20px; margin-bottom: 25px; border-bottom: 2px solid #aed6f1; background-color: #fff; border-radius: 0 0 8px 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .dashboard-header .logo h1 { margin: 0; font-size: 1.8em; color: #1a5276; }

        /* --- Dashboard Layout (ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯) --- */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Ø£ØµØ¨Ø­ Ù…ØªØ¬Ø§ÙˆØ¨Ù‹Ø§ Ø£ÙƒØ«Ø± */ grid-template-rows: auto; gap: 25px; }
        #daily-task { grid-column: span 2; } /* ÙŠØ£Ø®Ø° Ø¹Ù…ÙˆØ¯ÙŠÙ† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø³Ø§Ø­Ø© */
        #plan-progress {}
        #quick-stats {}
        #streak-level-section { /* Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù€ Streak */ }
        #calendar-view {}
        #competition-section {} /* ØªÙ… Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„ÙŠÙ‡ Ù…Ø¤Ù‚ØªØ§Ù‹ */
        #badges-section { grid-column: span 3; } /* ÙŠØ£Ø®Ø° Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ù…Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø³Ø§Ø­Ø© */

        /* Media query Ù„ØªØ¹Ø¯ÙŠÙ„ ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£ØµØºØ± */
        @media (max-width: 992px) {
             .dashboard-grid { grid-template-columns: repeat(2, 1fr); }
             #daily-task { grid-column: span 2; }
             #badges-section { grid-column: span 2; }
        }
        @media (max-width: 768px) { /* ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠ Ù„Ø´Ø§Ø´Ø§Øª Ø£ØµØºØ± */
             .dashboard-grid { grid-template-columns: 1fr; }
             #daily-task, #plan-progress, #quick-stats, #streak-level-section, #calendar-view, #competition-section, #badges-section { grid-column: span 1; }
        }
        @media (max-width: 600px) {
             .dashboard-header .logo h1 { font-size: 1.5em;}
             .card { padding: 15px; }
             h2 { font-size: 1.4em; }
             h3 { font-size: 1.1em; }
        }

        /* --- Section Specific Styles --- */
        #daily-task h3 { color: #1e8449; font-size: 1.3em; border-bottom: 2px solid #aed6f1; padding-bottom: 8px;}
        #daily-task-content { min-height: 80px; padding-top: 10px;} /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
        #daily-task-content p { margin-bottom: 0.6em; font-size: 1.05em; line-height: 1.8; }
        #daily-task-content strong { color: #1a5276; margin-left: 8px;}
        #daily-task .plan-link { margin-top: 15px; display: inline-block; font-size: 0.9em; background-color: #5dade2; color: white; padding: 5px 10px; border-radius: 4px; }
        #daily-task .plan-link:hover { background-color: #3498db; }

        #plan-progress h3, #quick-stats h3, #streak-level-section h3, #calendar-view h3, #competition-section h3, #badges-section h3 { font-size: 1.15em; }
        #plan-progress .progress-bar-container { background-color: #e9ecef; border-radius: 0.25rem; height: 25px; overflow: hidden; margin-top: 10px; border: 1px solid #ccc; }
        #plan-progress .progress-bar-value { background-color: #28a745; height: 100%; width: 0%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.9em; font-weight: bold; transition: width 0.6s ease-in-out; }
        #quick-stats ul { list-style: none; padding: 0; margin-top: 15px;}
        #quick-stats ul li { margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px dotted #eee; font-size: 0.95em;}
        #quick-stats ul li strong { margin-left: 5px; color: #1a5276; min-width: 110px; display: inline-block;}
        #quick-stats ul li span { color: #1e8449; font-weight: bold;}

        /* --- Styles for Streak & Level Section (Ø¬Ø¯ÙŠØ¯) --- */
        #streak-level-section .streak-info { margin-top: 15px; text-align: center; }
        #streak-level-section .streak-item { margin-bottom: 10px; }
        #streak-level-section .streak-label { font-weight: bold; color: #1a5276; display: block; margin-bottom: 3px; font-size: 0.95em; }
        #streak-level-section .streak-value { font-size: 1.4em; font-weight: bold; color: #1e8449; }
        #streak-level-section .level-title { font-size: 1.2em; font-weight: bold; color: #884ea0; margin-top: 15px; }
        #streak-level-section .level-icon { font-size: 2em; margin-right: 8px; vertical-align: middle; }

        /* --- Styles for Calendar (Ø¬Ø¯ÙŠØ¯) --- */
        #calendar-container { margin-top: 15px; }
        /* ØªØ®ØµÙŠØµ Ø£Ù„ÙˆØ§Ù† Ø£ÙŠØ§Ù… Ø§Ù„ØªÙ‚ÙˆÙŠÙ… */
        .vanilla-calendar-day--completed .vanilla-calendar-day__btn { background-color: #a9dfbf !important; color: #145a32 !important; font-weight: bold; }
        .vanilla-calendar-day--excused .vanilla-calendar-day__btn { background-color: #f5b7b1 !important; color: #922b21 !important; text-decoration: line-through; }
        .vanilla-calendar-day--today .vanilla-calendar-day__btn { border: 2px solid #2980b9 !important; background-color: #ebf5fb !important; color: #1a5276 !important; font-weight: bold; }
        /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
        .vanilla-calendar { width: 100%; max-width: 320px; margin: 0 auto; box-shadow: none; border: 1px solid #ddd; padding: 10px; }
        .vanilla-calendar-header { padding-bottom: 5px; }
        .vanilla-calendar-week__day { font-size: 0.8em; }
        .vanilla-calendar-day__btn { height: 30px; width: 30px; font-size: 0.85em; }

        /* Enhanced Placeholder Styles (ØªÙ… Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„ÙŠÙ‡Ø§ Ù„Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰) */
        .placeholder-box { min-height: 150px; background-color: #f0f4f8; border: 1px dashed #ccc; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #777; border-radius: 5px; padding: 15px; text-align: center; }
        .placeholder-box .icon { font-size: 3em; margin-bottom: 10px; opacity: 0.5; }
        .placeholder-box .text { font-style: italic; font-size: 0.9em; }

        /* Footer */
        .main-footer { text-align: center; padding: 20px; margin-top: 40px; background-color: #2c3e50; color: #ecf0f1; font-size: 0.9em; }
        .main-footer a { color: #3498db; }

        /* Action Buttons Hidden */
        .action-buttons { display: none; }

        /* Loading Indicator */
        #loading-indicator { text-align: center; padding: 50px; font-size: 1.3em; color: #1a5276; display: block; }

    </style>
</head>
<body>

    <div class="container">

        <header class="dashboard-header">
            <div class="logo"><h1>Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1></div>
        </header>

        <div id="loading-indicator">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

        <main id="dashboard-content" style="display: none;">

            <div class="dashboard-grid">

                <section id="daily-task" class="card">
                    <h3>ğŸŒŸ ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙŠÙˆÙ… (<span id="today-date-display">...</span>)</h3>
                    <div id="daily-task-content">
                        <p><i>ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ§Ø¬Ø¨...</i></p>
                    </div>
                    <a href="plangen2.html" class="plan-link">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ &raquo;</a>
                </section>

                <section id="plan-progress" class="card">
                    <h3>Ø§Ù„Ø®Ø·Ø© ÙˆØ§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…</h3>
                    <p><strong>Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù†Ø´Ø·Ø©:</strong> <span id="current-plan-name">-</span></p>
                    <p><strong>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ÙƒÙ„ÙŠ:</strong></p>
                    <div class="progress-bar-container">
                        <div id="progress-bar-value" class="progress-bar-value">0%</div>
                    </div>
                    <p style="font-size: 0.9em; text-align: center; margin-top: 5px;">
                        <span id="completed-pages-progress">0</span> / 604 ØµÙØ­Ø©
                    </p>
                </section>

                <section id="quick-stats" class="card">
                    <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                    <ul>
                        <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</strong> <span id="stat-memorized">0</span></li>
                        <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªÙ‚Ù†Ø©:</strong> <span id="stat-perfected">0</span></li>
                        <li><strong>Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©:</strong> <span id="stat-linked">0</span></li>
                        <li><strong>Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø¹Ø°Ø§Ø±:</strong> <span id="stat-excuses">0</span></li>
                    </ul>
                </section>

                <section id="streak-level-section" class="card">
                     <h3>ğŸ”¥ Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…ØªØªØ§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰</h3>
                     <div class="streak-info">
                         <div class="streak-item">
                             <span class="streak-label">Ø§Ù„Ù€ Streak Ø§Ù„Ø­Ø§Ù„ÙŠ:</span>
                             <span class="streak-value" id="current-streak">0</span> ÙŠÙˆÙ…
                         </div>
                         <div class="streak-item">
                             <span class="streak-label">Ø£Ø·ÙˆÙ„ Streak:</span>
                             <span class="streak-value" id="longest-streak">0</span> ÙŠÙˆÙ…
                         </div>
                         <div class="level-title">
                             <span class="level-icon" id="current-level-icon">ğŸ</span>
                             <span id="current-level-title">Ù…Ø¨ØªØ¯Ø¦</span>
                         </div>
                     </div>
                </section>

                <section id="calendar-view" class="card">
                    <h3>Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ÙˆØªØªØ¨Ø¹ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h3>
                    <div id="calendar-container">
                         <div id="vanilla-calendar" style="min-height: 280px;"></div>
                    </div>
                </section>

                <section id="competition-section" class="card">
                    <h3>Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©</h3>
                    <div class="placeholder-box">
                        <div class="icon">ğŸ†</div>
                        <div class="text">(Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©)</div>
                    </div>
                </section>

                <section id="badges-section" class="card">
                    <h3>Ø§Ù„Ø£ÙˆØ³Ù…Ø©</h3>
                    <div class="placeholder-box">
                        <div class="icon">ğŸ…</div>
                        <div class="text">(Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙˆØ³Ù…Ø© ÙˆØ§Ù„Ø­ÙˆØ§ÙØ²)</div>
                    </div>
                </section>

            </div>
        </main>

        <footer class="main-footer">
            <p>&copy; 2025 Ø®Ø·Ø© Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
        </footer>

    </div>

    <script>
        // --- Firebase Config (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const firebaseConfig = {
          apiKey: "AIzaSyDuUebu7Qzz3JnTfa-58EIPZjOcrkmdGHU",
          authDomain: "quranplan2.firebaseapp.com",
          projectId: "quranplan2",
          storageBucket: "quranplan2.appspot.com",
          messagingSenderId: "1098692856811",
          appId: "1:1098692856811:web:923bca3a54fd78b1b267ae"
        };

        // --- Initialize Firebase (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        try { firebase.initializeApp(firebaseConfig); } catch (e) { console.error("Firebase initialization error:", e); }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- DOM References (Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ø¬Ø¹ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©) ---
        const loadingIndicator = document.getElementById('loading-indicator');
        const dashboardContent = document.getElementById('dashboard-content');
        const dailyTaskContent = document.getElementById('daily-task-content');
        const currentPlanNameSpan = document.getElementById('current-plan-name');
        const progressBarValue = document.getElementById('progress-bar-value');
        const completedPagesProgressSpan = document.getElementById('completed-pages-progress');
        const statMemorized = document.getElementById('stat-memorized');
        const statPerfected = document.getElementById('stat-perfected');
        const statLinked = document.getElementById('stat-linked');
        const statExcuses = document.getElementById('stat-excuses');
        const todayDateSpan = document.getElementById('today-date-display');
        // Ù…Ø±Ø§Ø¬Ø¹ Ø¬Ø¯ÙŠØ¯Ø©
        const currentStreakSpan = document.getElementById('current-streak');
        const longestStreakSpan = document.getElementById('longest-streak');
        const currentLevelTitleSpan = document.getElementById('current-level-title');
        const currentLevelIconSpan = document.getElementById('current-level-icon');
        const calendarContainer = document.getElementById('vanilla-calendar');

        // --- Constants (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const totalQuranPages = 604;
        const initialTotalRows = 320; // Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ø®Ø·Ø©

        // --- Global State ---
        let currentUser = null;
        let currentPlanData = null; // Stores the FULL plan data
        let calendarInstance = null; // Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù…Ø±Ø¬Ø¹ Ù„Ù„ØªÙ‚ÙˆÙŠÙ…

        // --- Data Arrays & Helper Functions (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        const surahs = ['Ø§Ù„ÙØ§ØªØ­Ø© ÙˆØ§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø©', 'Ø§Ù„Ø¨Ù‚Ø±Ø© ÙˆØ¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡', 'Ø§Ù„Ù†Ø³Ø§Ø¡ ÙˆØ§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', 'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø© ÙˆØ§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ø¹Ø±Ø§Ù', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„Ø£Ù†ÙØ§Ù„', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø©', 'Ø§Ù„ØªÙˆØ¨Ø© ÙˆÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³', 'ÙŠÙˆÙ†Ø³ ÙˆÙ‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯', 'Ù‡ÙˆØ¯ ÙˆÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'ÙŠÙˆØ³Ù', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø§Ù„Ø±Ø¹Ø¯', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙˆØ§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø±', 'Ø§Ù„Ø­Ø¬Ø± ÙˆØ§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„', 'Ø§Ù„Ù†Ø­Ù„ ÙˆØ§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡', 'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡ ÙˆØ§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ø§Ù„ÙƒÙ‡Ù', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ…', 'Ù…Ø±ÙŠÙ… ÙˆØ·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡', 'Ø·Ù‡ ÙˆØ§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', 'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡ ÙˆØ§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬', 'Ø§Ù„Ø­Ø¬ ÙˆØ§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†', 'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ† ÙˆØ§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ±', 'Ø§Ù„Ù†ÙˆØ± ÙˆØ§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„ÙØ±Ù‚Ø§Ù†', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„', 'Ø§Ù„Ù†Ù…Ù„ ÙˆØ§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ', 'Ø§Ù„Ù‚ØµØµ ÙˆØ§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª', 'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª ÙˆØ§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ø§Ù„Ø±ÙˆÙ…', 'Ù„Ù‚Ù…Ø§Ù†', 'Ù„Ù‚Ù…Ø§Ù†', 'Ø§Ù„Ø³Ø¬Ø¯Ø©', 'Ø§Ù„Ø³Ø¬Ø¯Ø© ÙˆØ§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨', 'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨ ÙˆØ³Ø¨Ø£', 'Ø³Ø¨Ø£', 'Ø³Ø¨Ø£', 'Ø³Ø¨Ø£ ÙˆÙØ§Ø·Ø±', 'ÙØ§Ø·Ø±', 'ÙØ§Ø·Ø±', 'ÙØ§Ø·Ø± ÙˆÙŠØ³', 'ÙŠØ³', 'ÙŠØ³', 'ÙŠØ³ ÙˆØ§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Ø§Ù„ØµØ§ÙØ§Øª', 'Øµ', 'Øµ', 'Øµ ÙˆØ§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'Ø§Ù„Ø²Ù…Ø±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ØºØ§ÙØ±', 'ÙØµÙ„Øª', 'ÙØµÙ„Øª', 'ÙØµÙ„Øª', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰', 'Ø§Ù„Ø´ÙˆØ±Ù‰ ÙˆØ§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù', 'Ø§Ù„Ø²Ø®Ø±Ù ÙˆØ§Ù„Ø¯Ø®Ø§Ù†', 'Ø§Ù„Ø¯Ø®Ø§Ù†', 'Ø§Ù„Ø¬Ø§Ø«ÙŠØ©', 'Ø§Ù„Ø¬Ø§Ø«ÙŠØ© ÙˆØ§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ø§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ø§Ù„Ø£Ø­Ù‚Ø§Ù', 'Ù…Ø­Ù…Ø¯', 'Ù…Ø­Ù…Ø¯', 'Ø§Ù„ÙØªØ­', 'Ø§Ù„ÙØªØ­', 'Ø§Ù„ÙØªØ­ ÙˆØ§Ù„Ø­Ø¬Ø±Ø§Øª', 'Ø§Ù„Ø­Ø¬Ø±Ø§Øª Ùˆ Ù‚', 'Ù‚', 'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª', 'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª ÙˆØ§Ù„Ø·ÙˆØ±', 'Ø§Ù„Ø·ÙˆØ± ÙˆØ§Ù„Ù†Ø¬Ù…', 'Ø§Ù„Ù†Ø¬Ù… ÙˆØ§Ù„Ù‚Ù…Ø±', 'Ø§Ù„Ù‚Ù…Ø±', 'Ø§Ù„Ù‚Ù…Ø± ÙˆØ§Ù„Ø±Ø­Ù…Ù†', 'Ø§Ù„Ø±Ø­Ù…Ù† ÙˆØ§Ù„ÙˆØ§Ù‚Ø¹Ø©', 'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©', 'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø© ÙˆØ§Ù„Ø­Ø¯ÙŠØ¯', 'Ø§Ù„Ø­Ø¯ÙŠØ¯', 'Ø§Ù„Ø­Ø¯ÙŠØ¯ ÙˆØ§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©', 'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©', 'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø© ÙˆØ§Ù„Ø­Ø´Ø±', 'Ø§Ù„Ø­Ø´Ø±', 'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©', 'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø© ÙˆØ§Ù„ØµÙ', 'Ø§Ù„Ø¬Ù…Ø¹Ø© ÙˆØ§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†', 'Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ† ÙˆØ§Ù„ØªØºØ§Ø¨Ù†', 'Ø§Ù„ØªØºØ§Ø¨Ù† ÙˆØ§Ù„Ø·Ù„Ø§Ù‚', 'Ø§Ù„Ø·Ù„Ø§Ù‚ ÙˆØ§Ù„ØªØ­Ø±ÙŠÙ…', 'Ø§Ù„ØªØ­Ø±ÙŠÙ… ÙˆØ§Ù„Ù…Ù„Ùƒ', 'Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ù‚Ù„Ù…', 'Ø§Ù„Ù‚Ù„Ù… ÙˆØ§Ù„Ø­Ø§Ù‚Ø©', 'Ø§Ù„Ø­Ø§Ù‚Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ø±Ø¬', 'Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬ ÙˆÙ†ÙˆØ­', 'Ù†ÙˆØ­ ÙˆØ§Ù„Ø¬Ù†', 'Ø§Ù„Ø¬Ù† ÙˆØ§Ù„Ù…Ø²Ù…Ù„', 'Ø§Ù„Ù…Ø²Ù…Ù„ ÙˆØ§Ù„Ù…Ø¯Ø«Ø±', 'Ø§Ù„Ù…Ø¯Ø«Ø± ÙˆØ§Ù„Ù‚ÙŠØ§Ù…Ø© ÙˆØ§Ù„Ø¥Ù†Ø³Ø§Ù†', 'Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ÙˆØ§Ù„Ù…Ø±Ø³Ù„Ø§Øª', 'Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª ÙˆØ§Ù„Ù†Ø¨Ø£', 'Ø§Ù„Ù†Ø¨Ø£ ÙˆØ§Ù„Ù†Ø§Ø²Ø¹Ø§Øª', 'Ø¹Ø¨Ø³ ÙˆØ§Ù„ØªÙƒÙˆÙŠØ±', 'Ø§Ù„Ø¥Ù†ÙØ·Ø§Ø± ÙˆØ§Ù„Ù…Ø·ÙÙÙŠÙ†', 'Ø§Ù„Ø¥Ù†Ø´Ù‚Ø§Ù‚ ÙˆØ§Ù„Ø¨Ø±ÙˆØ¬', 'Ø§Ù„Ø·Ø§Ø±Ù‚ ÙˆØ§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ§Ù„ØºØ§Ø´ÙŠØ©', 'Ø§Ù„ÙØ¬Ø± ÙˆØ§Ù„Ø¨Ù„Ø¯', 'Ø§Ù„Ø´Ù…Ø³ ÙˆØ§Ù„Ù„ÙŠÙ„', 'Ø§Ù„Ø¶Ø­Ù‰ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§Ø³', 'Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†'];
        const linkFromData = ['', '', 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, 13,13,13,13,13,13,25,25,25,25,25,25,37,37,37,37,37,37,49,49,49,49,49,49,61,61,61,61,61,61, 73,73,73,73,73,73,85,85,85,85,85,85,97,97,97,97,97,97,109,109,109,109,109,109,121,121,121,121,121,121, 133,133,133,133,133,133,145,145,145,145,145,145,157,157,157,157,157,157,169,169,169,169,169,169,181,181,181,181,181,181, 193,193,193,193,193,193,205,205,205,205,205,205,217,217,217,217,217,217,229,229,229,229,229,229,241,241,241,241,241,241, 253,253,253,253,253,253,265,265,265,265,265,265,277,277,277,277,277,277,289,289,289,289,289,289,301,301,301,301,301,301, 313,313,313,313,313,313,325,325,325,325,325,325,337,337,337,337,337,337,349,349,349,349,349,349,361,361,361,361,361,361, 373,373,373,373,373,373,385,385,385,385,385,385,397,397,397,397,397,397,409,409,409,409,409,409,421,421,421,421,421,421, 433,433,433,433,433,433,445,445,445,445,445,445,457,457,457,457,457,457,469,469,469,469,469,469,481,481,481,481,481,481, 493,493,493,493,493,493,505,505,505,505,505,505,517,517,517,517,517,517,529,529,529,529,529,529,541,541,541,541,541,541, 553,553,553,553,553,553,565,565,565,565,565,565,577,577,577,577,577,577];
        const linkToData = ['', '', 2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60, 62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116, 118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168, 170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220, 222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,256,258,260,262,264,266,268,270,272, 274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,312,314,316,318,320,322,324, 326,328,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,376, 378,380,382,384,386,388,390,392,394,396,398,400,402,404,406,408,410,412,414,416,418,420,422,424,426,428, 430,432,434,436,438,440,442,444,446,448,450,452,454,456,458,460,462,464,466,468,470,472,474,476,478,480, 482,484,486,488,490,492,494,496,498,500,502,504,506,508,510,512,514,516,518,520,522,524,526,528,530,532, 534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,564,566,568,570,572,574,576,578,580,582,584, 586,588,590,592,594,597,600,604];
        const reviewFromData = [...Array(32).fill(''), 1,3,5,7,9,11,1,5,9,13,17,21,1,7,13,19,25,31,1,9,17,25,33,41, 1,11,21,31,41,51,1,13,25,37,49,61,1,15,29,43,57,71,1,17,33,49,65,81, 1,19,37,55,73,91,1,21,41,61,81,101,1,23,45,67,89,111,1,25,49,73,97,121, 1,27,53,79,105,131,1,29,57,85,113,141,1,31,61,91,121,151,1,33,65,97,129,161, 1,35,69,103,137,171,1,37,73,109,145,181,1,39,77,115,153,191,1,41,81,121,161,201, 1,43,85,127,169,211,1,45,89,133,177,221,1,47,93,139,185,231,1,49,97,145,193,241, 1,51,101,151,201,251,1,53,105,157,209,261,1,55,109,163,217,271,1,57,113,169,225,281, 1,59,117,175,233,291,1,61,121,181,241,301,1,63,125,187,249,311,1,65,129,193,257,321, 1,67,133,199,265,331,1,69,137,205,273,341,1,71,141,211,281,351,1,73,145,217,289,361, 1,75,149,223,297,371,1,77,153,229,305,381,1,79,157,235,313,391,1,81,161,241,321,401, 1,83,165,247,329,411,1,85,169,253,337,421,1,87,173,259,345,431,1,89,177,265,353,441, 1,91,181,271,361,451,1,93,185,277,369,461,1,95,189,283,377,471,1,97,193,289,385,481];
        const reviewToData = [...Array(32).fill(''), 2,4,6,8,10,12,4,8,12,16,20,24,6,12,18,24,30,36,8,16,24,32,40,48, 10,20,30,40,50,60,12,24,36,48,60,72,14,28,42,56,70,84,16,32,48,64,80,96, 18,36,54,72,90,108,20,40,60,80,100,120,22,44,66,88,110,132,24,48,72,96,120,144, 26,52,78,104,130,156,28,56,84,112,140,168,30,60,90,120,150,180,32,64,96,128,160,192, 34,68,102,136,170,204,36,72,108,144,180,216,38,76,114,152,190,228,40,80,120,160,200,240, 42,84,126,168,210,252,44,88,132,176,220,264,46,92,138,184,230,276,48,96,144,192,240,288, 50,100,150,200,250,300,52,104,156,208,260,312,54,108,162,216,270,324,56,112,168,224,280,336, 58,116,174,232,290,348,60,120,180,240,300,360,62,124,186,248,310,372,64,128,192,256,320,384, 66,132,198,264,330,396,68,136,204,272,340,408,70,140,210,280,350,420,72,144,216,288,360,432, 74,148,222,296,370,444,76,152,228,304,380,456,78,156,234,312,390,468,80,160,240,320,400,480, 82,164,246,328,410,492,84,168,252,336,420,504,86,172,258,344,430,516,88,176,264,352,440,528, 90,180,270,360,450,540,92,184,276,368,460,552,94,188,282,376,470,564,96,192,288,384,480,576];

        // --- Helper Functions (Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ù„ØªØ§Ø±ÙŠØ®) ---
        function formatDate(date) { if (!(date instanceof Date)) date = new Date(date); if (isNaN(date.getTime())) return ""; const year = date.getFullYear(); const month = String(date.getMonth() + 1).padStart(2, '0'); const day = String(date.getDate()).padStart(2, '0'); return `${year}-${month}-${day}`; }
        function getDateFromString(dateString) { // YYYY-MM-DD
            if (!dateString) return null;
            const parts = dateString.split('-');
            if (parts.length !== 3) return null;
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø´Ù‡Ø± ÙÙŠ ÙƒØ§Ø¦Ù† Date ÙŠØ¨Ø¯Ø£ Ù…Ù† 0 (ÙŠÙ†Ø§ÙŠØ±)
            return new Date(Date.UTC(parseInt(parts[0]), parseInt(parts[1]) - 1, parseInt(parts[2])));
        }
        function getPlanData(originalIndex) { const index = parseInt(originalIndex); if (isNaN(index) || index < 0 || index >= initialTotalRows) { return null; } let fromPage = '', toPage = ''; if (index < 299) { fromPage = index * 2 + 1; toPage = fromPage + 1; } else if (index === 299) { fromPage = 601; toPage = 604; } return { fromPage: fromPage, toPage: toPage, surah: surahs[index] || '', linkFrom: linkFromData[index] ?? '', linkTo: linkToData[index] ?? '', reviewFrom: reviewFromData[index] ?? '', reviewTo: reviewToData[index] ?? '', round: calculateRoundNumber(index) }; }
        function calculateRoundNumber(originalIndex) { if (originalIndex < 32 || !reviewFromData || reviewFromData[originalIndex] == null || reviewFromData[originalIndex] === '') { return ''; } let reviewDataStartIndex = 32; let reviewCounter = 0; for(let i = reviewDataStartIndex; i <= originalIndex; i++){ if(reviewFromData[i] != null && reviewFromData[i] !== '') reviewCounter++; } if (reviewCounter === 0) return ''; return Math.ceil(reviewCounter / 6); }

        // --- UI Update Functions ---
        function showLoading(message = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...") { if(loadingIndicator){ loadingIndicator.textContent = message; loadingIndicator.style.display = 'block';} if(dashboardContent) dashboardContent.style.display = 'none'; }
        function hideLoading() { if(loadingIndicator) loadingIndicator.style.display = 'none'; }
        function displayDashboard() { hideLoading(); if(dashboardContent) dashboardContent.style.display = 'block'; }

        // --- Functions to Calculate Stats from tableRows (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        function calculateDashboardStats(tableRows) {
            let lastCompletedPage = 0;
            let linkedTasks = 0;
            let perfectedTasks = 0; // Based on 'reviewed' state
            let excuseCount = 0;

            if (!tableRows) return { memorizedPages: 0, linkedTasks: 0, perfectedTasks: 0, excuseCount: 0 };

            tableRows.forEach(row => {
                if (row.type === 'excuse') {
                    excuseCount++;
                } else if (row.type === 'plan' && row.state && row.state.completed) {
                    const planInfo = getPlanData(row.originalSequence);
                    if (planInfo && planInfo.toPage) {
                        const pageNum = parseInt(planInfo.toPage);
                        if (!isNaN(pageNum)) {
                            lastCompletedPage = Math.max(lastCompletedPage, pageNum);
                        }
                    }
                    if (planInfo && planInfo.linkTo !== '' && row.state.linked) {
                        linkedTasks++;
                    }
                    if (planInfo && planInfo.reviewTo !== '' && row.state.reviewed) {
                        perfectedTasks++;
                    }
                }
            });
            const memorizedPages = Math.min(lastCompletedPage, totalQuranPages);
            return { memorizedPages: memorizedPages, linkedTasks: linkedTasks, perfectedTasks: perfectedTasks, excuseCount: excuseCount };
        }

        // --- Levels & Titles Definition (Ø¬Ø¯ÙŠØ¯) ---
        const levelsAndTitles = [
            { level: 0, title: 'Ù…Ø¨ØªØ¯Ø¦', icon: 'ğŸ' }, // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
            { level: 1, title: 'Ø³Ø§Ø¹Ù Ù„Ù„Ø¹Ù„Ø§', icon: 'ğŸŒ±' }, // 10-19
            { level: 2, title: 'Ù…Ø«Ø§Ø¨Ø± Ù…Ø¬ØªÙ‡Ø¯', icon: 'ğŸƒâ€â™‚ï¸' }, // 20-29
            { level: 3, title: 'ØµØ§Ø­Ø¨ Ù‡Ù…Ø©', icon: 'ğŸ’ª' }, // 30-39
            { level: 4, title: 'Ø±ÙÙŠÙ‚ Ø§Ù„Ù‚Ø±Ø¢Ù†', icon: 'ğŸ“–' }, // 40-49
            { level: 5, title: 'Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù…', icon: 'ğŸ“' }, // 50-59
            { level: 6, title: 'Ø­Ø§ÙØ¸ Ù…ØªÙ‚Ù†', icon: 'âœ¨' }, // 60-69
            { level: 7, title: 'Ù…Ù† Ø£Ù‡Ù„ Ø§Ù„Ù„Ù‡ ÙˆØ®Ø§ØµØªÙ‡', icon: 'ğŸ’–' }, // 70-79
            { level: 8, title: 'Ù†Ø¬Ù… Ø³Ø§Ø·Ø¹', icon: 'ğŸŒŸ' }, // 80-89
            { level: 9, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø¦Ø© ÙŠÙˆÙ…', icon: 'ğŸ’¯' }, // 90-99
            { level: 10, title: 'Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ù…Ø³ÙŠØ±Ø©', icon: 'ğŸ†' }, // 100-109 - Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ù…ÙŠØ²Ø©
            { level: 11, title: 'Ø­Ø§Ù…Ù„ Ø§Ù„Ù„ÙˆØ§Ø¡', icon: 'ğŸš©' }, // 110-119
            { level: 12, title: 'Ù…ÙØ¹Ù„Ù… Ø§Ù„Ø£Ø¬ÙŠØ§Ù„', icon: 'ğŸ‘¨â€ğŸ«' }, // 120-129
            { level: 13, title: 'Ù‚Ø¯ÙˆØ© Ø­Ø³Ù†Ø©', icon: 'â­' }, // 130-139
            { level: 14, title: 'Ø¥Ù…Ø§Ù… Ù…ØªÙ‚Ù†', icon: 'ğŸ•Œ' }, // 140-149
            { level: 15, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ø¹Ø²ÙŠÙ…Ø© Ø§Ù„ÙÙˆÙ„Ø§Ø°ÙŠØ©', icon: 'ğŸ¦¾' }, // 150-159
            { level: 16, title: 'Ù†ÙˆØ± Ø¹Ù„Ù‰ Ù†ÙˆØ±', icon: 'ğŸ’¡' }, // 160-169
            { level: 17, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø¦ØªÙŠ ÙŠÙˆÙ…', icon: 'ğŸ…' }, // 170-179
            { level: 18, title: 'Ù…ÙØ¬Ø¯Ø¯ Ø§Ù„Ù‡Ù…Ù…', icon: 'ğŸš€' }, // 180-189
            { level: 19, title: 'ÙØ§Ø±Ø³ Ø§Ù„Ù‚Ø±Ø¢Ù†', icon: 'âš”ï¸' }, // 190-199
            { level: 20, title: 'Ø®Ø§Ø¯Ù… Ø§Ù„ÙƒØªØ§Ø¨', icon: 'ğŸ“š' }, // 200-209
            { level: 21, title: 'Ù…ÙØ­Ù‚Ù‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù', icon: 'ğŸ¯' }, // 210-219
            { level: 22, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ø¹Ø§Ù…Ø±', icon: 'â¤ï¸' }, // 220-229
            { level: 23, title: 'Ø³ÙÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†', icon: 'ğŸŒ' }, // 230-239
            { level: 24, title: 'Ø¬Ø¨Ù„ Ø´Ø§Ù…Ø®', icon: 'â›°ï¸' }, // 240-249
            { level: 25, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø© ÙŠÙˆÙ…', icon: 'ğŸ‘‘' }, // 250-259
            { level: 26, title: 'Ø±Ø§ÙØ¹ Ø§Ù„Ù‡Ù…Ø©', icon: 'ğŸ“ˆ' }, // 260-269
            { level: 27, title: 'Ù…ÙØªÙ‚Ù† Ù…ÙØ¹Ù„Ù…', icon: 'ğŸ¥‡' }, // 270-279
            { level: 28, title: 'ÙˆØ§Ø±Ø« Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡', icon: 'ğŸ™' }, // 280-289
            { level: 29, title: 'Ù†Ø¨Ø±Ø§Ø³ Ø§Ù„Ù‡Ø¯Ù‰', icon: 'ğŸ•¯ï¸' }, // 290-299
            { level: 30, title: 'ØµØ§Ø­Ø¨ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¹Ø¸ÙŠÙ…', icon: 'ğŸ‰' }, // 300-309
            { level: 31, title: 'Ø±ÙÙŠÙ‚ Ø§Ù„Ù…Ù„Ø£ Ø§Ù„Ø£Ø¹Ù„Ù‰', icon: 'ğŸ•Šï¸' }, // 310-319
            { level: 32, title: 'Ø®Ø§ØªÙ… Ø§Ù„Ø­ÙØ§Ø¸ Ø§Ù„Ø£Ø¨Ø±Ø§Ø±', icon: 'ğŸ‡' }, // 320+
        ];

        // --- Function to Calculate Streak & Level (Ø¬Ø¯ÙŠØ¯) ---
        function calculateStreaksAndLevel(tableRows, todayStr) {
            if (!tableRows || tableRows.length === 0) {
                return { currentStreak: 0, longestStreak: 0, currentLevel: 0, highestLevelAchieved: 0, effectiveLevel: 0 };
            }

            let currentStreak = 0;
            let longestStreak = 0;
            let tempStreak = 0;
            let lastCompletionDate = null; // ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ÙŠÙˆÙ… ØªÙ… Ø¥ÙƒÙ…Ø§Ù„Ù‡
            let highestLevelAchieved = 0; // Ø£Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ ØªØ§Ø±ÙŠØ®ÙŠÙ‹Ø§
            let streakBroken = false; // Ù‡Ù„ Ø§Ù†ÙƒØ³Ø± Ø§Ù„Ø³ØªØ±ÙŠÙƒ Ù…Ø¤Ø®Ø±Ù‹Ø§ØŸ

            // ÙØ±Ø² Ø§Ù„ØµÙÙˆÙ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªØ±ØªÙŠØ¨
            const sortedRows = [...tableRows].sort((a, b) => {
                const dateA = getDateFromString(a.displayDate);
                const dateB = getDateFromString(b.displayDate);
                if (!dateA || !dateB) return 0;
                return dateA - dateB;
            });

            const todayDate = getDateFromString(todayStr);
            let yesterdayDate = new Date(todayDate);
            yesterdayDate.setDate(yesterdayDate.getDate() - 1);

            // Ø­Ø³Ø§Ø¨ Ø£Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ Ø³Ø§Ø¨Ù‚Ø§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø·ÙˆÙ„ Streak ØªØ§Ø±ÙŠØ®ÙŠ
            // Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ®Ø²ÙŠÙ† Ø£Ø·ÙˆÙ„ streak ÙÙŠ Firestore Ø¥Ø°Ø§ Ø£Ø±Ø¯Ù†Ø§ Ø¯Ù‚Ø© ØªØ§Ø±ÙŠØ®ÙŠØ©
            // ÙƒØ­Ù„ Ù…Ø¤Ù‚ØªØŒ Ø³Ù†Ø­Ø³Ø¨Ù‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ tableRows
            let historicalLongestStreak = 0;
            let tempHistoricalStreak = 0;
             sortedRows.forEach(row => {
                 if (row.type === 'plan' && row.state?.completed) {
                     tempHistoricalStreak++;
                 } else {
                     historicalLongestStreak = Math.max(historicalLongestStreak, tempHistoricalStreak);
                     tempHistoricalStreak = 0; // Reset streak if not completed or excuse
                 }
             });
             historicalLongestStreak = Math.max(historicalLongestStreak, tempHistoricalStreak); // Check last sequence
             highestLevelAchieved = Math.floor(historicalLongestStreak / 10);


            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù€ Streak Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ£Ø·ÙˆÙ„ Streak (Ù…Ø¹ Ø§Ø¹ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹)
            for (const row of sortedRows) {
                const rowDate = getDateFromString(row.displayDate);
                if (!rowDate || rowDate >= todayDate) {
                    // Ù†ØªÙˆÙ‚Ù Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ù„Ø³ØªØ±ÙŠÙƒ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø§Ø¶ÙŠØ©)
                    break;
                }

                if (row.type === 'plan' && row.state?.completed) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø§Ù†Ù‚Ø·Ø§Ø¹ Ù‚Ø¨Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                    if (lastCompletionDate && (rowDate - lastCompletionDate) > (1000 * 60 * 60 * 24 + 60000)) { // Ø£ÙƒØ«Ø± Ù…Ù† ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯ ÙØ±Ù‚ (Ù†Ø¶ÙŠÙ Ø¯Ù‚ÙŠÙ‚Ø© Ø§Ø­ØªÙŠØ§Ø·)
                        longestStreak = Math.max(longestStreak, tempStreak);
                        tempStreak = 1; // Ø¨Ø¯Ø§ÙŠØ© Ø³ØªØ±ÙŠÙƒ Ø¬Ø¯ÙŠØ¯
                        streakBroken = true; // Ø­Ø¯Ø« Ø§Ù†Ù‚Ø·Ø§Ø¹
                    } else {
                        tempStreak++;
                    }
                    lastCompletionDate = rowDate; // ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ø¥ÙƒÙ…Ø§Ù„
                } else {
                    // Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø¨Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø£Ùˆ Ø¹Ø°Ø±
                    longestStreak = Math.max(longestStreak, tempStreak);
                    tempStreak = 0;
                    if(rowDate <= yesterdayDate) { // ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹ Ù‚Ø¨Ù„ ÙŠÙˆÙ… Ø£Ù…Ø³
                       streakBroken = true;
                    }
                    lastCompletionDate = null; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ø¥ÙƒÙ…Ø§Ù„
                }
            }
            longestStreak = Math.max(longestStreak, tempStreak); // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³ØªØ±ÙŠÙƒ Ø§Ù„Ø£Ø®ÙŠØ±
            currentStreak = tempStreak; // Ø§Ù„Ø³ØªØ±ÙŠÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‡Ùˆ Ø¢Ø®Ø± Ø³ØªØ±ÙŠÙƒ Ù…ØªØµÙ„

            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù€ Streak Ø§Ù„Ø­Ø§Ù„ÙŠ
            let currentLevel = Math.min(32, Math.floor(currentStreak / 10));

            // ØªØ·Ø¨ÙŠÙ‚ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù…Ø³ØªÙˆÙ‰ ÙˆØ§Ø­Ø¯ Ù„Ù„Ø®Ù„Ù Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹
            let effectiveLevel = currentLevel;
            if (streakBroken && currentStreak === 0) { // Ø¥Ø°Ø§ Ø§Ù†ÙƒØ³Ø± Ø§Ù„Ø³ØªØ±ÙŠÙƒ ØªÙ…Ø§Ù…Ù‹Ø§ Ø§Ù„ÙŠÙˆÙ…
                 effectiveLevel = Math.max(0, highestLevelAchieved - 1);
            } else {
                 // Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø§Ù„Ø³ØªØ±ÙŠÙƒ Ø£Ùˆ Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯ØŒ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù‡Ùˆ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
                 effectiveLevel = currentLevel;
                 // ØªØ­Ø¯ÙŠØ« Ø£Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ÙˆØµÙ„ Ø¥Ù„ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³ØªØ±ÙŠÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£ÙƒØ¨Ø±*
                 if (currentLevel > highestLevelAchieved) {
                     highestLevelAchieved = currentLevel;
                     // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ù„ØªØ­Ø¯ÙŠØ« highestLevelAchieved ÙÙŠ Firestore Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„
                 }
            }


            // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙØ¹Ø§Ù„ Ù„Ø§ ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
             effectiveLevel = Math.min(32, effectiveLevel);


            return {
                currentStreak: currentStreak,
                longestStreak: longestStreak, // Ø£Ùˆ historicalLongestStreak Ø¥Ø°Ø§ Ø£Ø±Ø¯Ù†Ø§ Ø§Ù„Ø£Ø·ÙˆÙ„ ØªØ§Ø±ÙŠØ®ÙŠÙ‹Ø§ Ø¨Ø´ÙƒÙ„ Ø£Ø¯Ù‚
                highestLevelAchieved: highestLevelAchieved,
                effectiveLevel: effectiveLevel // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶Ù‡
            };
        }


        // --- Function to Initialize and Update Calendar (Ø¬Ø¯ÙŠØ¯) ---
        function initializeAndUpdateCalendar(tableRows, todayStr) {
            if (!calendarContainer) return;

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªÙ‚ÙˆÙŠÙ…
            const markedDates = [];
            let firstPlanDate = null;

            if (tableRows && tableRows.length > 0) {
                tableRows.forEach(row => {
                    if (!firstPlanDate && row.displayDate) {
                        firstPlanDate = row.displayDate; // ØªØ­Ø¯ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø£ÙˆÙ„ ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø®Ø·Ø©
                    }
                    if (row.displayDate) {
                        let cssClass = '';
                        if (row.type === 'excuse') {
                            cssClass = 'vanilla-calendar-day--excused';
                        } else if (row.type === 'plan' && row.state?.completed) {
                            cssClass = 'vanilla-calendar-day--completed';
                        }

                        if (row.displayDate === todayStr) {
                            cssClass += ' vanilla-calendar-day--today'; // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ø§Ø³ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
                        }

                        if (cssClass) {
                            markedDates.push({
                                date: row.displayDate,
                                description: row.type === 'excuse' ? `Ø¹Ø°Ø±: ${row.excuseType || ''}` : (row.state?.completed ? 'ØªÙ… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²' : 'Ù…Ù‚Ø±Ø±'), // Ù†Øµ ÙˆØµÙÙŠ Ø§Ø®ØªÙŠØ§Ø±ÙŠ
                                cssClass: cssClass.trim() // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ø§Ø³Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©
                            });
                        } else if (row.displayDate === todayStr) {
                             // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ù†Ø¬Ø²Ù‹Ø§ Ø£Ùˆ Ø¹Ø°Ø±Ù‹Ø§
                              markedDates.push({
                                date: row.displayDate,
                                description: 'Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ',
                                cssClass: 'vanilla-calendar-day--today'
                            });
                        }
                    }
                });
            }

             // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¹Ø±Ø¶Ù‡ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… (Ø´Ù‡Ø± Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ùˆ Ø´Ù‡Ø± Ø£ÙˆÙ„ ÙŠÙˆÙ… Ø¨Ø§Ù„Ø®Ø·Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠÙ‹Ø§)
            const initialCalendarDate = firstPlanDate ? new Date(firstPlanDate + 'T00:00:00Z') : new Date();
            if (new Date() > initialCalendarDate) {
                initialCalendarDate = new Date(); // Ø§Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ Ø¨Ø¯Ø£Øª Ø§Ù„Ø®Ø·Ø© Ø¨Ø§Ù„ÙØ¹Ù„
            }


            const options = {
                type: 'month', // Ø¹Ø±Ø¶ Ø´Ù‡Ø±ÙŠ
                settings: {
                    lang: 'ar-SA', // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„ØªÙ‚ÙˆÙŠÙ…
                    iso8601: false, // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø£Ø­Ø¯
                    range: {
                        disablePast: false, // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø±Ø¤ÙŠØ© Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø§Ø¶ÙŠØ©
                    },
                    visibility: {
                        theme: 'light', // Ø£Ùˆ 'dark'
                        weekend: false, // Ø¹Ø¯Ù… ØªÙ…ÙŠÙŠØ² Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§
                        today: false, // ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØªÙ… Ø¹Ø¨Ø± Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ø®ØµØµ
                    },
                     selection: {
                        day: false, // ØªØ¹Ø·ÙŠÙ„ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙŠØ§Ù… Ø¨Ø§Ù„Ù†Ù‚Ø±
                    },
                     // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ù…ÙŠØ²Ø©
                     selected: {
                         dates: markedDates.map(d => d.date), // ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø£ÙŠØ§Ù…
                         modifier: (dayEl, date) => { // Ø¯Ø§Ù„Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙ„Ø§Ø³Ø§Øª
                              const mark = markedDates.find(d => d.date === date);
                              if (mark && mark.cssClass) {
                                  mark.cssClass.split(' ').forEach(cls => dayEl.classList.add(cls));
                              }
                         }
                    }
                },
                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¹Ø±Ø¶
                 date: {
                     today: initialCalendarDate // Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ùˆ Ø´Ù‡Ø± Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø®Ø·Ø©
                }
            };

            // ØªØ¯Ù…ÙŠØ± Ø§Ù„Ù…Ø«ÙŠÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ù‚Ø¨Ù„ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø­Ø¯ Ø¬Ø¯ÙŠØ¯
            if (calendarInstance) {
                calendarInstance.destroy();
            }
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
             if (typeof VanillaCalendar !== 'undefined') {
                calendarInstance = new VanillaCalendar(calendarContainer, options);
                calendarInstance.init();
            } else {
                console.error("Vanilla JS Calendar library not loaded.");
                calendarContainer.innerHTML = "<p>Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ….</p>";
            }
        }


        // --- MODIFIED Functions to Update Dashboard Sections ---
        function displayDailyTask() {
            if (!dailyTaskContent || !currentPlanData || !currentPlanData.tableRows) {
                if(dailyTaskContent) dailyTaskContent.innerHTML = '<p><i>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·Ø©...</i></p>';
                if (todayDateSpan) todayDateSpan.textContent = formatDate(new Date());
                return;
            }

            const tableRows = currentPlanData.tableRows;
            const today = new Date();
            const todayStr = formatDate(today);

            if (todayDateSpan) todayDateSpan.textContent = todayStr;

            const todayRow = tableRows.find(row => row.displayDate === todayStr);

            if (!todayRow) {
                 dailyTaskContent.innerHTML = '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨ Ù…Ù‚Ø±Ø± ÙÙŠ Ø§Ù„Ø®Ø·Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….</p>';
            } else if (todayRow.type === 'excuse') {
                dailyTaskContent.innerHTML = `<p style="color: orange; font-weight:bold;">Ù„Ø¯ÙŠÙƒ Ø¹Ø°Ø± Ù…Ø³Ø¬Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… (${todayRow.excuseType || ''}).</p>`;
            } else if (todayRow.type === 'plan' && todayRow.state && todayRow.state.completed) {
                dailyTaskContent.innerHTML = '<p style="color: green; font-weight: bold;">âœ… Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª ÙˆØ§Ø¬Ø¨ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…!</p>';
            } else if (todayRow.type === 'plan') { // Ù„Ø§ Ø¯Ø§Ø¹ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† state Ù„Ø£Ù†Ù‡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ù„ØµÙ Ø§Ù„Ø®Ø·Ø©
                const taskDetails = getPlanData(todayRow.originalSequence);
                if (taskDetails) {
                    let taskHTML = `<h4>Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¥Ù†Ø¬Ø§Ø²Ù‡ Ø§Ù„ÙŠÙˆÙ… (${todayStr}):</h4>`;
                    taskHTML += `<p><strong>Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</strong> ${taskDetails.fromPage ? `Øµ ${taskDetails.fromPage} - ${taskDetails.toPage}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'} (${taskDetails.surah || 'Ù…Ø±Ø§Ø¬Ø¹Ø©'})</p>`;
                    taskHTML += `<p><strong>Ø§Ù„Ø±Ø¨Ø·:</strong> ${taskDetails.linkFrom ? `Ù…Ù† ${taskDetails.linkFrom} Ø¥Ù„Ù‰ ${taskDetails.linkTo}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>`;
                    taskHTML += `<p><strong>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:</strong> ${taskDetails.reviewFrom ? `Ù…Ù† ${taskDetails.reviewFrom} Ø¥Ù„Ù‰ ${taskDetails.reviewTo}` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'} ${taskDetails.round ? `(Ø¬${taskDetails.round})` : ''}</p>`;
                    dailyTaskContent.innerHTML = taskHTML;
                } else {
                    dailyTaskContent.innerHTML = `<p><i>Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù„Ù„ÙÙ‡Ø±Ø³ ${todayRow.originalSequence}.</i></p>`;
                }
            } else {
                dailyTaskContent.innerHTML = '<p><i>Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙŠÙˆÙ….</i></p>';
            }
        }

        function displayProgress(stats) {
            if (!currentPlanData) return;
            const planType = currentPlanData.planType || '?';
            const memorizedPages = stats.memorizedPages;
            const progressPercent = totalQuranPages > 0 ? Math.min(100, (memorizedPages / totalQuranPages) * 100).toFixed(0) : 0;
            if(currentPlanNameSpan) currentPlanNameSpan.textContent = `Ø®Ø·Ø© ${planType} ØµÙØ­Ø§Øª`;
            if(progressBarValue) {
                progressBarValue.style.width = `${progressPercent}%`;
                progressBarValue.style.backgroundColor = '#28a745';
                progressBarValue.textContent = `${progressPercent}%`;
            }
            if(completedPagesProgressSpan) completedPagesProgressSpan.textContent = memorizedPages;
        }

        function displayStats(stats) {
            if(statMemorized) statMemorized.textContent = stats.memorizedPages;
            if(statPerfected) statPerfected.textContent = stats.perfectedTasks;
            if(statLinked) statLinked.textContent = stats.linkedTasks;
            if(statExcuses) statExcuses.textContent = stats.excuseCount;
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ù… Ø§Ù„Ù€ Streak ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰ (Ø¬Ø¯ÙŠØ¯)
        function displayStreaksAndLevel(streakData) {
             if (!currentStreakSpan || !longestStreakSpan || !currentLevelTitleSpan || !currentLevelIconSpan) return;

             currentStreakSpan.textContent = streakData.currentStreak;
             longestStreakSpan.textContent = streakData.longestStreak;

            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù„Ù‚Ø¨ ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙØ¹Ø§Ù„
             const levelInfo = levelsAndTitles.find(l => l.level === streakData.effectiveLevel) || levelsAndTitles[0]; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 0 ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ

             currentLevelTitleSpan.textContent = levelInfo.title;
             currentLevelIconSpan.textContent = levelInfo.icon;
        }


        // --- Main Data Loading Function (ØªØ¹Ø¯ÙŠÙ„ Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù€ Streak ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…) ---
        function loadDashboardData(user) {
            if (!user) return;
            const uid = user.uid;
            const planRef = db.collection("quranPlans").doc(uid);
            console.log("Dashboard: Checking Firestore for plan:", uid);
            showLoading("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø·ØªÙƒ...");

            planRef.get().then((doc) => {
                hideLoading();
                if (doc.exists) {
                    console.log("Dashboard: Plan data found.");
                    currentPlanData = doc.data();

                    if (!currentPlanData.startDate || !currentPlanData.planType || !currentPlanData.tableRows || !Array.isArray(currentPlanData.tableRows) || !currentPlanData.repetitionMax) {
                        console.error("Loaded data missing required fields (startDate, planType, tableRows array, or repetitionMax).", currentPlanData);
                        displayDashboard(); // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                        dailyTaskContent.innerHTML = `<p style="color:red; font-weight:bold;">Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø·ØªÙƒ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø© Ø£Ùˆ ØªØ§Ù„ÙØ©. ÙŠØ±Ø¬Ù‰ <a href="index.html">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</a> ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø©.</p>`;
                         // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£ Ø¬ÙˆÙ‡Ø±ÙŠ
                         document.getElementById('plan-progress').style.display = 'none';
                         document.getElementById('quick-stats').style.display = 'none';
                         document.getElementById('streak-level-section').style.display = 'none';
                         document.getElementById('calendar-view').style.display = 'none';
                        return;
                    }

                    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    const stats = calculateDashboardStats(currentPlanData.tableRows);

                    // Ø­Ø³Ø§Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Streak ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰ (Ø¬Ø¯ÙŠØ¯)
                    const todayStr = formatDate(new Date());
                    const streakData = calculateStreaksAndLevel(currentPlanData.tableRows, todayStr);

                    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    displayDailyTask();
                    displayProgress(stats);
                    displayStats(stats);
                    displayStreaksAndLevel(streakData); // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Streak (Ø¬Ø¯ÙŠØ¯)
                    initializeAndUpdateCalendar(currentPlanData.tableRows, todayStr); // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… (Ø¬Ø¯ÙŠØ¯)

                    displayDashboard(); // Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡

                } else {
                    console.log("Dashboard: No plan data found.");
                    displayDashboard(); // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø·Ø©"
                    dailyTaskContent.innerHTML = '<p style="color:orange; font-weight:bold;">Ù„Ù… ØªÙ‚Ù… Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¨Ø¹Ø¯!</p><p>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ <a href="index.html">ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</a> Ù„Ø§Ø®ØªÙŠØ§Ø± Ø®Ø·ØªÙƒ.</p>';
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø©
                    document.getElementById('plan-progress').style.display = 'none';
                    document.getElementById('quick-stats').style.display = 'none';
                    document.getElementById('streak-level-section').style.display = 'none';
                    document.getElementById('calendar-view').style.display = 'none';
                    document.getElementById('competition-section').style.display = 'none';
                    document.getElementById('badges-section').style.display = 'none';
                }
            }).catch((error) => {
                console.error("Error getting plan document:", error);
                hideLoading();
                displayDashboard(); // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                dailyTaskContent.innerHTML = `<p style="color:red; font-weight:bold;">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·Ø©. (${error.code || 'UNKNOWN'})</p><p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Firestore. <a href="index.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></p>`;
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£
                document.getElementById('plan-progress').style.display = 'none';
                document.getElementById('quick-stats').style.display = 'none';
                 document.getElementById('streak-level-section').style.display = 'none';
                 document.getElementById('calendar-view').style.display = 'none';
            });
        }

        // --- Authentication Listener (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        auth.onAuthStateChanged(user => {
            hideLoading();
            currentUser = user;
            if (user) {
                console.log("Dashboard: Auth state OK.");
                loadDashboardData(user);
            } else {
                console.log("Dashboard: Not logged in. Redirecting to index...");
                // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ø³Ù… ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ØµØ­ÙŠØ­
                window.location.replace('index.html'); // Ø£Ùˆ login.html
            }
        });

        // --- Initial Load (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        document.addEventListener('DOMContentLoaded', () => {
            showLoading("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...");
        });

        // --- Print Function (ÙƒÙ…Ø§ Ù‡ÙŠ) ---
        function printData() { console.log("Initiating browser print..."); window.print(); }

    </script>

</body>
</html>